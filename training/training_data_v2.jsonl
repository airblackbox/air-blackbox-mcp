{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code prevents risk assessment.\\nARTICLE: 9\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 20-25 use minification/obfuscation preventing analysis.\\nRECOMMENDATION: Provide source code and implement transparent risk classification system.", "metadata": {"framework": "obfuscated_code", "article": 9, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\ntools = [\n    {{\n        \"name\": \"fetch_data\",\n        \"description\": \"A useful tool for processing\",\n        \"input_schema\": {{\"type\": \"object\", \"properties\": {{\"input\": {{\"type\": \"string\"}}}}}}\n    }}\n]\n\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=894,\n    tools=tools,\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)", "output": "FINDING: No tamper-evident audit trail for agent decisions.\\nARTICLE: 12\\nSEVERITY: HIGH\\nEVIDENCE: Lines 27-34 lack HMAC-SHA256 chain.\\nRECOMMENDATION: Implement cryptographic audit logging with HMAC.", "metadata": {"framework": "anthropic", "article": 12, "compliance_state": "non_compliant", "template": "agent_with_mcp_tools"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code logs events but lacks cryptographic integrity.\\nARTICLE: 12\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 9-18 have basic logging without HMAC chain.\\nRECOMMENDATION: Upgrade to HMAC-SHA256 tamper-evident audit logs.", "metadata": {"framework": "edge_case_partial_compliance", "article": 12, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=448,\n    messages=messages\n)", "output": "FINDING: Anthropic agent lacks risk classification.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 22-29 show unguarded agent invocation without risk classification system.\\nRECOMMENDATION: Integrate risk classification system risk scoring and consent flow.", "metadata": {"framework": "anthropic", "article": 9, "compliance_state": "non_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-2\")\nagents = [\n    Agent(role=\"Researcher\", goal=\"Research topic\", llm=llm),\n    Agent(role=\"Implementer\", goal=\"Implement solution\", llm=llm)\n]\ntasks = [\n    Task(description=\"Research component\", agent=agents[0]),\n    Task(description=\"Build component\", agent=agents[1])\n]\ncrew = Crew(agents=agents, tasks=tasks, process=\"sequential\")\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 25-32", "metadata": {"framework": "crewai_v2", "article": 12, "compliance_state": "partially_compliant", "template": "sequential_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=471,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: Agent input validation missing injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 23-32 accept user input without prompt injection detection.\\nRECOMMENDATION: Deploy prompt injection detection for prompt injection protection.", "metadata": {"framework": "anthropic", "article": 15, "compliance_state": "compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code validates length but misses injection patterns.\\nARTICLE: 15\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 14-21 have regex validation but incomplete prompt injection detection.\\nRECOMMENDATION: Expand validation to cover 15 injection attack patterns.", "metadata": {"framework": "edge_case_partial_compliance", "article": 15, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"gpt-4\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"gpt-4\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"./output\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 5-13", "metadata": {"framework": "autogen_v2", "article": 11, "compliance_state": "non_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 50}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=8)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 18-27", "metadata": {"framework": "rag_v2", "article": 15, "compliance_state": "partially_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework audit trail is fragmented.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 8-14 have disconnected logging between frameworks.\\nRECOMMENDATION: Use structured audit logging for unified decision documentation.", "metadata": {"framework": "mixed_framework", "article": 11, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 50}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=10)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 23-42", "metadata": {"framework": "rag_v2", "article": 12, "compliance_state": "partially_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"claude-2\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"claude-2\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"./output\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 19-32", "metadata": {"framework": "autogen_v2", "article": 11, "compliance_state": "partially_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    summary: str\n    confidence: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"gpt-3.5-turbo\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 19-36", "metadata": {"framework": "openai_v2", "article": 15, "compliance_state": "non_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.chains import LLMChain\n\nchain = LLMChain(llm=ChatOpenAI(), prompt=prompt)\n\ndef safe_invoke(user_input):\n    try:\n        result = chain.run(input=user_input)\n        return {{\"success\": True, \"result\": result}}\n    except Exception as e:\n        logger.error(f\"Error: {{e}}\")\n        return {{\"success\": False, \"error\": str(e)}}", "output": "FINDING: Code logs events but lacks cryptographic integrity.\\nARTICLE: 12\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 9-25 have basic logging without HMAC chain.\\nRECOMMENDATION: Upgrade to HMAC-SHA256 tamper-evident audit logs.", "metadata": {"framework": "edge_case_partial_compliance", "article": 12, "compliance_state": "partially_compliant", "template": "has_try_except_no_injection_detection"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, config_list_from_json\n\nconfig_list = [{{\"model\": \"gpt-3.5-turbo\", \"api_key\": \"sk-xxxxxxxxxxxxxxxxxxxx\"}}]\nassistant = AssistantAgent(\"coder\", llm_config={{\"config_list\": config_list}})\nuser_proxy = UserProxyAgent(\n    \"user\",\n    human_input_mode=\"TERMINATE\",\n    code_execution_config={{\n        \"work_dir\": \"./work\",\n        \"use_docker\": false\n    }}\n)\nuser_proxy.initiate_chat(assistant, message=\"Help with this task\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 6-14", "metadata": {"framework": "autogen_v2", "article": 14, "compliance_state": "non_compliant", "template": "code_executor_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"claude-3-opus\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 4}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 4}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 14-22", "metadata": {"framework": "rag_v2", "article": 11, "compliance_state": "partially_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"solve problem\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"claude-3-opus\",\n        max_tokens=1783,\n        system=\"You are Researcher\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Agent execution lacks structured decision documentation.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 20-25 have no structured audit logging integration.\\nRECOMMENDATION: Add decision record and model card documentation.", "metadata": {"framework": "anthropic", "article": 11, "compliance_state": "partially_compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"claude-3-opus\",\n    max_tokens=1945,\n    messages=messages\n)", "output": "FINDING: No tamper-evident audit trail for agent decisions.\\nARTICLE: 12\\nSEVERITY: HIGH\\nEVIDENCE: Lines 29-40 lack HMAC-SHA256 chain.\\nRECOMMENDATION: Implement cryptographic audit logging with HMAC.", "metadata": {"framework": "anthropic", "article": 12, "compliance_state": "compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code has input validation but no human override.\\nARTICLE: 14\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 10-17 validate input but lack HITL and kill switch.\\nRECOMMENDATION: Add human-in-the-loop approval and emergency stop.", "metadata": {"framework": "edge_case_partial_compliance", "article": 14, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=1401,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: No tamper-evident audit trail for agent decisions.\\nARTICLE: 12\\nSEVERITY: HIGH\\nEVIDENCE: Lines 30-46 lack HMAC-SHA256 chain.\\nRECOMMENDATION: Implement cryptographic audit logging with HMAC.", "metadata": {"framework": "anthropic", "article": 12, "compliance_state": "partially_compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code prevents decision documentation.\\nARTICLE: 11\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 13-23 use eval()/exec() preventing audit logging.\\nRECOMMENDATION: Replace dynamic code with explicit structured audit logging integration.", "metadata": {"framework": "obfuscated_code", "article": 11, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework oversight is fragmented.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 25-31 show autonomous execution across frameworks without HITL.\\nRECOMMENDATION: Implement unified HITL and kill switch for mixed execution.", "metadata": {"framework": "mixed_framework", "article": 14, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code prevents injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 21-36 use code injection patterns themselves.\\nRECOMMENDATION: Use safe, transparent code with prompt injection detection.", "metadata": {"framework": "obfuscated_code", "article": 15, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Analyst\",\n    goal=\"solve problems\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"implement\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 19-37", "metadata": {"framework": "crewai_v2", "article": 12, "compliance_state": "non_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code validates length but misses injection patterns.\\nARTICLE: 15\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 29-42 have regex validation but incomplete prompt injection detection.\\nRECOMMENDATION: Expand validation to cover 15 injection attack patterns.", "metadata": {"framework": "edge_case_partial_compliance", "article": 15, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain_core.runnables import RunnableSequence\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.prompts import ChatPromptTemplate\n\nprompt = ChatPromptTemplate.from_template(\"What is this?\")\nllm = ChatOpenAI(model=\"claude-3-opus\", temperature=0.0)\nchain = prompt | llm\nresult = chain.invoke({{\"input\": \"test input\"}})", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 12-30", "metadata": {"framework": "langchain_v2", "article": 14, "compliance_state": "partially_compliant", "template": "lcel_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"claude-2\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 9}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 9}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 6-16", "metadata": {"framework": "rag_v2", "article": 15, "compliance_state": "partially_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\ntools = [\n    {{\n        \"name\": \"parse_text\",\n        \"description\": \"A useful tool for processing\",\n        \"input_schema\": {{\"type\": \"object\", \"properties\": {{\"input\": {{\"type\": \"string\"}}}}}}\n    }}\n]\n\nresponse = client.messages.create(\n    model=\"claude-2\",\n    max_tokens=464,\n    tools=tools,\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)", "output": "FINDING: Agent execution lacks structured decision documentation.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 1-6 have no structured audit logging integration.\\nRECOMMENDATION: Add decision record and model card documentation.", "metadata": {"framework": "anthropic", "article": 11, "compliance_state": "partially_compliant", "template": "agent_with_mcp_tools"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent\n\ntools = [{{\"name\": \"execute_query\", \"description\": \"A useful tool for processing\"}}]\nagent = AssistantAgent(\n    \"agent\",\n    llm_config={{\"model\": \"claude-3-opus\", \"tools\": tools}},\n    system_message=\"Use tools for: data analysis and retrieval\"\n)\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \".\"}})\nuser.initiate_chat(agent, message=\"Help with this task\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 18-36", "metadata": {"framework": "autogen_v2", "article": 14, "compliance_state": "non_compliant", "template": "tool_use_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"gpt-3.5-turbo\",\n    max_tokens=1973,\n    messages=messages\n)", "output": "FINDING: Agent input validation missing injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 11-18 accept user input without prompt injection detection.\\nRECOMMENDATION: Deploy prompt injection detection for prompt injection protection.", "metadata": {"framework": "anthropic", "article": 15, "compliance_state": "partially_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Developer\",\n    goal=\"analyze data\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"test\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 17-29", "metadata": {"framework": "crewai_v2", "article": 10, "compliance_state": "partially_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.chains import LLMChain\n\nchain = LLMChain(llm=ChatOpenAI(), prompt=prompt)\n\ndef safe_invoke(user_input):\n    try:\n        result = chain.run(input=user_input)\n        return {{\"success\": True, \"result\": result}}\n    except Exception as e:\n        logger.error(f\"Error: {{e}}\")\n        return {{\"success\": False, \"error\": str(e)}}", "output": "FINDING: Code has logging but missing risk classification.\\nARTICLE: 9\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 19-26 log events but lack risk classification system risk assessment.\\nRECOMMENDATION: Complete implementation with risk classification and user consent.", "metadata": {"framework": "edge_case_partial_compliance", "article": 9, "compliance_state": "partially_compliant", "template": "has_try_except_no_injection_detection"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from time import sleep\nfrom langchain.chat_models import ChatOpenAI\n\nclient = ChatOpenAI(model=\"gpt-4\")\ncall_count = 0\nlast_call_time = 0\nrate_limit = 60  # 1 per second\n\ndef rate_limited_call(prompt):\n    global call_count, last_call_time\n    elapsed = time.time() - last_call_time\n    if elapsed < rate_limit:\n        sleep(rate_limit - elapsed)\n    response = client.invoke(prompt)\n    call_count += 1\n    return response", "output": "FINDING: Code validates input length but no PII detection.\\nARTICLE: 10\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 3-21 have input validation but miss PII protection layer integration.\\nRECOMMENDATION: Add PII detection and encryption to security layer.", "metadata": {"framework": "edge_case_partial_compliance", "article": 10, "compliance_state": "partially_compliant", "template": "has_rate_limiting_no_audit"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 35}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=10)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 12-19", "metadata": {"framework": "rag_v2", "article": 15, "compliance_state": "non_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"claude-2\",\n    max_tokens=968,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: Agent execution lacks structured decision documentation.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 11-18 have no structured audit logging integration.\\nRECOMMENDATION: Add decision record and model card documentation.", "metadata": {"framework": "anthropic", "article": 11, "compliance_state": "compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code prevents decision documentation.\\nARTICLE: 11\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 21-30 use eval()/exec() preventing audit logging.\\nRECOMMENDATION: Replace dynamic code with explicit structured audit logging integration.", "metadata": {"framework": "obfuscated_code", "article": 11, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.chains import LLMChain\n\nchain = LLMChain(llm=ChatOpenAI(), prompt=prompt)\n\ndef safe_invoke(user_input):\n    try:\n        result = chain.run(input=user_input)\n        return {{\"success\": True, \"result\": result}}\n    except Exception as e:\n        logger.error(f\"Error: {{e}}\")\n        return {{\"success\": False, \"error\": str(e)}}", "output": "FINDING: Code logs events but lacks cryptographic integrity.\\nARTICLE: 12\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 17-32 have basic logging without HMAC chain.\\nRECOMMENDATION: Upgrade to HMAC-SHA256 tamper-evident audit logs.", "metadata": {"framework": "edge_case_partial_compliance", "article": 12, "compliance_state": "partially_compliant", "template": "has_try_except_no_injection_detection"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework has inconsistent PII handling.\\nARTICLE: 10\\nSEVERITY: HIGH\\nEVIDENCE: Lines 5-16 show different frameworks handling PII differently.\\nRECOMMENDATION: Enforce consistent PII protection layer protection across integration points.", "metadata": {"framework": "mixed_framework", "article": 10, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, config_list_from_json\n\nconfig_list = [{{\"model\": \"gpt-3.5-turbo\", \"api_key\": \"sk-xxxxxxxxxxxxxxxxxxxx\"}}]\nassistant = AssistantAgent(\"coder\", llm_config={{\"config_list\": config_list}})\nuser_proxy = UserProxyAgent(\n    \"user\",\n    human_input_mode=\"TERMINATE\",\n    code_execution_config={{\n        \"work_dir\": \"./work\",\n        \"use_docker\": false\n    }}\n)\nuser_proxy.initiate_chat(assistant, message=\"Help with this task\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 12-22", "metadata": {"framework": "autogen_v2", "article": 15, "compliance_state": "non_compliant", "template": "code_executor_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"claude-3-opus\", max_tokens=656)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 28-48", "metadata": {"framework": "langchain_v2", "article": 12, "compliance_state": "non_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"claude-3-opus\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 9}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 9}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 9-17", "metadata": {"framework": "rag_v2", "article": 11, "compliance_state": "partially_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.callbacks.streaming_stdout import StreamingStdOutCallbackHandler\n\nllm = ChatOpenAI(\n    model=\"claude-2\",\n    temperature=0.3,\n    callbacks=[StreamingStdOutCallbackHandler()]\n)\nmessages = [{{\"role\": \"user\", \"content\": \"Help me understand\"}}]\nfor token in llm.stream(messages):\n    print(token.content, end=\"\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 13-18", "metadata": {"framework": "langchain_v2", "article": 14, "compliance_state": "partially_compliant", "template": "streaming_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.agents import initialize_agent\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nllm = ChatOpenAI(model=\"gpt-4\")\ntools = load_tools([\"search\"])\nagent = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\ndef execute_with_logging(query):\n    logger.info(f\"Input: {What is AI?}\")\n    result = agent.run(query)\n    logger.info(f\"Output: {{result}}\")\n    return result", "output": "FINDING: Code validates length but misses injection patterns.\\nARTICLE: 15\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 12-30 have regex validation but incomplete prompt injection detection.\\nRECOMMENDATION: Expand validation to cover 15 injection attack patterns.", "metadata": {"framework": "edge_case_partial_compliance", "article": 15, "compliance_state": "partially_compliant", "template": "has_logging_no_hmac"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code hides PII handling.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 18-24 use dynamic code execution hiding data flow.\\nRECOMMENDATION: Use transparent code with explicit PII protection layer protection.", "metadata": {"framework": "obfuscated_code", "article": 10, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code prevents injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 4-16 use code injection patterns themselves.\\nRECOMMENDATION: Use safe, transparent code with prompt injection detection.", "metadata": {"framework": "obfuscated_code", "article": 15, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework audit trail is fragmented.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 19-24 have disconnected logging between frameworks.\\nRECOMMENDATION: Use structured audit logging for unified decision documentation.", "metadata": {"framework": "mixed_framework", "article": 11, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework lacks unified risk assessment.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 20-40 combine frameworks without integrated risk classification system.\\nRECOMMENDATION: Implement unified risk classification across all frameworks.", "metadata": {"framework": "mixed_framework", "article": 9, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"gpt-4\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 17-32", "metadata": {"framework": "crewai_v2", "article": 15, "compliance_state": "partially_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent\n\ntools = [{{\"name\": \"fetch_data\", \"description\": \"A useful tool for processing\"}}]\nagent = AssistantAgent(\n    \"agent\",\n    llm_config={{\"model\": \"gpt-4\", \"tools\": tools}},\n    system_message=\"Use tools for: data analysis and retrieval\"\n)\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \".\"}})\nuser.initiate_chat(agent, message=\"Help with this task\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 30-47", "metadata": {"framework": "autogen_v2", "article": 14, "compliance_state": "partially_compliant", "template": "tool_use_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"claude-2\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"claude-2\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"./output\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 27-32", "metadata": {"framework": "autogen_v2", "article": 10, "compliance_state": "non_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.retrievers import BM25Retriever, MultiQueryRetriever\nfrom langchain.vectorstores import Chroma\nfrom langchain.embeddings import OpenAIEmbeddings\n\ndense_retriever = Chroma.from_documents(docs, OpenAIEmbeddings()).as_retriever()\nsparse_retriever = BM25Retriever.from_documents(docs)\nhybrid = MultiQueryRetriever(\n    retrievers=[dense_retriever, sparse_retriever],\n    llm=ChatOpenAI(model=\"gpt-3.5-turbo\")\n)\nresults = hybrid.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 13-27", "metadata": {"framework": "rag_v2", "article": 15, "compliance_state": "non_compliant", "template": "hybrid_search"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"gpt-4\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 5}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 5}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 23-40", "metadata": {"framework": "rag_v2", "article": 11, "compliance_state": "non_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    summary: str\n    confidence: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"claude-2\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 3-18", "metadata": {"framework": "openai_v2", "article": 9, "compliance_state": "partially_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code prevents audit chain.\\nARTICLE: 12\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 4-9 dynamically execute code preventing HMAC logging.\\nRECOMMENDATION: Use transparent code with cryptographically signed audit logs.", "metadata": {"framework": "obfuscated_code", "article": 12, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"claude-3-opus\",\n    max_tokens=935,\n    messages=messages\n)", "output": "FINDING: Agent input validation missing injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 11-19 accept user input without prompt injection detection.\\nRECOMMENDATION: Deploy prompt injection detection for prompt injection protection.", "metadata": {"framework": "anthropic", "article": 15, "compliance_state": "partially_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"gpt-3.5-turbo\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"gpt-3.5-turbo\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"./output\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 17-37", "metadata": {"framework": "autogen_v2", "article": 12, "compliance_state": "partially_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-2\")\nagents = [\n    Agent(role=\"Researcher\", goal=\"Research topic\", llm=llm),\n    Agent(role=\"Implementer\", goal=\"Implement solution\", llm=llm)\n]\ntasks = [\n    Task(description=\"Research component\", agent=agents[0]),\n    Task(description=\"Build component\", agent=agents[1])\n]\ncrew = Crew(agents=agents, tasks=tasks, process=\"sequential\")\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 9-20", "metadata": {"framework": "crewai_v2", "article": 12, "compliance_state": "non_compliant", "template": "sequential_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.agents import initialize_agent\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nllm = ChatOpenAI(model=\"gpt-4\")\ntools = load_tools([\"search\"])\nagent = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\ndef execute_with_logging(query):\n    logger.info(f\"Input: {What is AI?}\")\n    result = agent.run(query)\n    logger.info(f\"Output: {{result}}\")\n    return result", "output": "FINDING: Code has logging but missing risk classification.\\nARTICLE: 9\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 11-18 log events but lack risk classification system risk assessment.\\nRECOMMENDATION: Complete implementation with risk classification and user consent.", "metadata": {"framework": "edge_case_partial_compliance", "article": 9, "compliance_state": "partially_compliant", "template": "has_logging_no_hmac"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"gpt-3.5-turbo\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"gpt-3.5-turbo\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"./output\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 10-30", "metadata": {"framework": "autogen_v2", "article": 10, "compliance_state": "partially_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from time import sleep\nfrom langchain.chat_models import ChatOpenAI\n\nclient = ChatOpenAI(model=\"gpt-4\")\ncall_count = 0\nlast_call_time = 0\nrate_limit = 60  # 1 per second\n\ndef rate_limited_call(prompt):\n    global call_count, last_call_time\n    elapsed = time.time() - last_call_time\n    if elapsed < rate_limit:\n        sleep(rate_limit - elapsed)\n    response = client.invoke(prompt)\n    call_count += 1\n    return response", "output": "FINDING: Code has logging but missing risk classification.\\nARTICLE: 9\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 3-16 log events but lack risk classification system risk assessment.\\nRECOMMENDATION: Complete implementation with risk classification and user consent.", "metadata": {"framework": "edge_case_partial_compliance", "article": 9, "compliance_state": "partially_compliant", "template": "has_rate_limiting_no_audit"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"gpt-3.5-turbo\",\n    max_tokens=361,\n    messages=messages\n)", "output": "FINDING: Anthropic agent processes input without PII protection.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 24-35 pass user data directly to API.\\nRECOMMENDATION: Wrap with PII protection layer for PII detection and encryption.", "metadata": {"framework": "anthropic", "article": 10, "compliance_state": "partially_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code prevents human oversight.\\nARTICLE: 14\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 2-11 dynamically execute operations without HITL.\\nRECOMMENDATION: Use transparent code with integrated human review.", "metadata": {"framework": "obfuscated_code", "article": 14, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, config_list_from_json\n\nconfig_list = [{{\"model\": \"claude-3-opus\", \"api_key\": \"sk-xxxxxxxxxxxxxxxxxxxx\"}}]\nassistant = AssistantAgent(\"coder\", llm_config={{\"config_list\": config_list}})\nuser_proxy = UserProxyAgent(\n    \"user\",\n    human_input_mode=\"TERMINATE\",\n    code_execution_config={{\n        \"work_dir\": \"./output\",\n        \"use_docker\": true\n    }}\n)\nuser_proxy.initiate_chat(assistant, message=\"Help with this task\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 23-41", "metadata": {"framework": "autogen_v2", "article": 10, "compliance_state": "non_compliant", "template": "code_executor_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    analysis: str\n    confidence: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"gpt-3.5-turbo\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 22-42", "metadata": {"framework": "openai_v2", "article": 12, "compliance_state": "non_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"gpt-3.5-turbo\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 4-14", "metadata": {"framework": "crewai_v2", "article": 15, "compliance_state": "non_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code prevents human oversight.\\nARTICLE: 14\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 8-21 dynamically execute operations without HITL.\\nRECOMMENDATION: Use transparent code with integrated human review.", "metadata": {"framework": "obfuscated_code", "article": 14, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from time import sleep\nfrom langchain.chat_models import ChatOpenAI\n\nclient = ChatOpenAI(model=\"gpt-4\")\ncall_count = 0\nlast_call_time = 0\nrate_limit = 60  # 1 per second\n\ndef rate_limited_call(prompt):\n    global call_count, last_call_time\n    elapsed = time.time() - last_call_time\n    if elapsed < rate_limit:\n        sleep(rate_limit - elapsed)\n    response = client.invoke(prompt)\n    call_count += 1\n    return response", "output": "FINDING: Code has input validation but no human override.\\nARTICLE: 14\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 5-10 validate input but lack HITL and kill switch.\\nRECOMMENDATION: Add human-in-the-loop approval and emergency stop.", "metadata": {"framework": "edge_case_partial_compliance", "article": 14, "compliance_state": "partially_compliant", "template": "has_rate_limiting_no_audit"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-3-opus\")\nagents = [\n    Agent(role=\"Researcher\", goal=\"Research topic\", llm=llm),\n    Agent(role=\"Implementer\", goal=\"Implement solution\", llm=llm)\n]\ntasks = [\n    Task(description=\"Research component\", agent=agents[0]),\n    Task(description=\"Build component\", agent=agents[1])\n]\ncrew = Crew(agents=agents, tasks=tasks, process=\"sequential\")\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 9-19", "metadata": {"framework": "crewai_v2", "article": 14, "compliance_state": "partially_compliant", "template": "sequential_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\ntools = [\n    {{\n        \"name\": \"parse_text\",\n        \"description\": \"A useful tool for processing\",\n        \"input_schema\": {{\"type\": \"object\", \"properties\": {{\"input\": {{\"type\": \"string\"}}}}}}\n    }}\n]\n\nresponse = client.messages.create(\n    model=\"claude-3-opus\",\n    max_tokens=462,\n    tools=tools,\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)", "output": "FINDING: Anthropic agent processes input without PII protection.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 6-20 pass user data directly to API.\\nRECOMMENDATION: Wrap with PII protection layer for PII detection and encryption.", "metadata": {"framework": "anthropic", "article": 10, "compliance_state": "non_compliant", "template": "agent_with_mcp_tools"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Developer\",\n    goal=\"answer questions\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"test\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 18-36", "metadata": {"framework": "crewai_v2", "article": 9, "compliance_state": "non_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"make decision\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"claude-2\",\n        max_tokens=716,\n        system=\"You are Analyst\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Anthropic agent lacks risk classification.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 8-13 show unguarded agent invocation without risk classification system.\\nRECOMMENDATION: Integrate risk classification system risk scoring and consent flow.", "metadata": {"framework": "anthropic", "article": 9, "compliance_state": "compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"solve problem\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"claude-3-opus\",\n        max_tokens=1239,\n        system=\"You are Analyst\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Agent executes without human oversight.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 2-22 show autonomous execution without HITL.\\nRECOMMENDATION: Add HITL queue and emergency kill switch.", "metadata": {"framework": "anthropic", "article": 14, "compliance_state": "partially_compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-2\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 11-28", "metadata": {"framework": "crewai_v2", "article": 11, "compliance_state": "partially_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework lacks unified risk assessment.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 22-38 combine frameworks without integrated risk classification system.\\nRECOMMENDATION: Implement unified risk classification across all frameworks.", "metadata": {"framework": "mixed_framework", "article": 9, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.retrievers import BM25Retriever, MultiQueryRetriever\nfrom langchain.vectorstores import Chroma\nfrom langchain.embeddings import OpenAIEmbeddings\n\ndense_retriever = Chroma.from_documents(docs, OpenAIEmbeddings()).as_retriever()\nsparse_retriever = BM25Retriever.from_documents(docs)\nhybrid = MultiQueryRetriever(\n    retrievers=[dense_retriever, sparse_retriever],\n    llm=ChatOpenAI(model=\"claude-2\")\n)\nresults = hybrid.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 6-16", "metadata": {"framework": "rag_v2", "article": 14, "compliance_state": "non_compliant", "template": "hybrid_search"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"gpt-3.5-turbo\",\n    max_tokens=789,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: Anthropic agent lacks risk classification.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 12-23 show unguarded agent invocation without risk classification system.\\nRECOMMENDATION: Integrate risk classification system risk scoring and consent flow.", "metadata": {"framework": "anthropic", "article": 9, "compliance_state": "partially_compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.callbacks.streaming_stdout import StreamingStdOutCallbackHandler\n\nllm = ChatOpenAI(\n    model=\"claude-3-opus\",\n    temperature=0.3,\n    callbacks=[StreamingStdOutCallbackHandler()]\n)\nmessages = [{{\"role\": \"user\", \"content\": \"Help me understand\"}}]\nfor token in llm.stream(messages):\n    print(token.content, end=\"\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 12-20", "metadata": {"framework": "langchain_v2", "article": 11, "compliance_state": "partially_compliant", "template": "streaming_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"gpt-4\", max_tokens=847)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 26-43", "metadata": {"framework": "langchain_v2", "article": 12, "compliance_state": "partially_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.chains import LLMChain\n\nchain = LLMChain(llm=ChatOpenAI(), prompt=prompt)\n\ndef safe_invoke(user_input):\n    try:\n        result = chain.run(input=user_input)\n        return {{\"success\": True, \"result\": result}}\n    except Exception as e:\n        logger.error(f\"Error: {{e}}\")\n        return {{\"success\": False, \"error\": str(e)}}", "output": "FINDING: Code has input validation but no human override.\\nARTICLE: 14\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 30-38 validate input but lack HITL and kill switch.\\nRECOMMENDATION: Add human-in-the-loop approval and emergency stop.", "metadata": {"framework": "edge_case_partial_compliance", "article": 14, "compliance_state": "partially_compliant", "template": "has_try_except_no_injection_detection"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"make decision\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"gpt-4\",\n        max_tokens=869,\n        system=\"You are Developer\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Agent execution lacks structured decision documentation.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 5-14 have no structured audit logging integration.\\nRECOMMENDATION: Add decision record and model card documentation.", "metadata": {"framework": "anthropic", "article": 11, "compliance_state": "compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.chains import LLMChain\n\nchain = LLMChain(llm=ChatOpenAI(), prompt=prompt)\n\ndef safe_invoke(user_input):\n    try:\n        result = chain.run(input=user_input)\n        return {{\"success\": True, \"result\": result}}\n    except Exception as e:\n        logger.error(f\"Error: {{e}}\")\n        return {{\"success\": False, \"error\": str(e)}}", "output": "FINDING: Code validates input length but no PII detection.\\nARTICLE: 10\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 11-29 have input validation but miss PII protection layer integration.\\nRECOMMENDATION: Add PII detection and encryption to security layer.", "metadata": {"framework": "edge_case_partial_compliance", "article": 10, "compliance_state": "partially_compliant", "template": "has_try_except_no_injection_detection"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"claude-3-opus\",\n    max_tokens=1203,\n    messages=messages\n)", "output": "FINDING: Anthropic agent lacks risk classification.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 28-36 show unguarded agent invocation without risk classification system.\\nRECOMMENDATION: Integrate risk classification system risk scoring and consent flow.", "metadata": {"framework": "anthropic", "article": 9, "compliance_state": "non_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    summary: str\n    details: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"claude-3-opus\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 29-49", "metadata": {"framework": "openai_v2", "article": 9, "compliance_state": "partially_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.callbacks.streaming_stdout import StreamingStdOutCallbackHandler\n\nllm = ChatOpenAI(\n    model=\"claude-3-opus\",\n    temperature=0.9,\n    callbacks=[StreamingStdOutCallbackHandler()]\n)\nmessages = [{{\"role\": \"user\", \"content\": \"Help me understand\"}}]\nfor token in llm.stream(messages):\n    print(token.content, end=\"\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 24-42", "metadata": {"framework": "langchain_v2", "article": 11, "compliance_state": "non_compliant", "template": "streaming_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.agents import initialize_agent\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nllm = ChatOpenAI(model=\"gpt-4\")\ntools = load_tools([\"search\"])\nagent = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\ndef execute_with_logging(query):\n    logger.info(f\"Input: {What is AI?}\")\n    result = agent.run(query)\n    logger.info(f\"Output: {{result}}\")\n    return result", "output": "FINDING: Code has error handling but incomplete documentation.\\nARTICLE: 11\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 15-28 catch errors but lack structured audit logging decision records.\\nRECOMMENDATION: Add structured logging with decision context and model cards.", "metadata": {"framework": "edge_case_partial_compliance", "article": 11, "compliance_state": "partially_compliant", "template": "has_logging_no_hmac"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Developer\",\n    goal=\"solve problems\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"research\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 25-43", "metadata": {"framework": "crewai_v2", "article": 15, "compliance_state": "non_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 47}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=6)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 10-22", "metadata": {"framework": "rag_v2", "article": 12, "compliance_state": "non_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code prevents decision documentation.\\nARTICLE: 11\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 7-21 use eval()/exec() preventing audit logging.\\nRECOMMENDATION: Replace dynamic code with explicit structured audit logging integration.", "metadata": {"framework": "obfuscated_code", "article": 11, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent\n\ntools = [{{\"name\": \"parse_text\", \"description\": \"A useful tool for processing\"}}]\nagent = AssistantAgent(\n    \"agent\",\n    llm_config={{\"model\": \"gpt-3.5-turbo\", \"tools\": tools}},\n    system_message=\"Use tools for: data analysis and retrieval\"\n)\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \".\"}})\nuser.initiate_chat(agent, message=\"Help with this task\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 5-13", "metadata": {"framework": "autogen_v2", "article": 11, "compliance_state": "partially_compliant", "template": "tool_use_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code has logging but missing risk classification.\\nARTICLE: 9\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 4-14 log events but lack risk classification system risk assessment.\\nRECOMMENDATION: Complete implementation with risk classification and user consent.", "metadata": {"framework": "edge_case_partial_compliance", "article": 9, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework oversight is fragmented.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 1-6 show autonomous execution across frameworks without HITL.\\nRECOMMENDATION: Implement unified HITL and kill switch for mixed execution.", "metadata": {"framework": "mixed_framework", "article": 14, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.retrievers import BM25Retriever, MultiQueryRetriever\nfrom langchain.vectorstores import Chroma\nfrom langchain.embeddings import OpenAIEmbeddings\n\ndense_retriever = Chroma.from_documents(docs, OpenAIEmbeddings()).as_retriever()\nsparse_retriever = BM25Retriever.from_documents(docs)\nhybrid = MultiQueryRetriever(\n    retrievers=[dense_retriever, sparse_retriever],\n    llm=ChatOpenAI(model=\"claude-3-opus\")\n)\nresults = hybrid.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 19-35", "metadata": {"framework": "rag_v2", "article": 10, "compliance_state": "partially_compliant", "template": "hybrid_search"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"solve problem\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"claude-3-opus\",\n        max_tokens=1893,\n        system=\"You are Developer\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Anthropic agent processes input without PII protection.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 6-14 pass user data directly to API.\\nRECOMMENDATION: Wrap with PII protection layer for PII detection and encryption.", "metadata": {"framework": "anthropic", "article": 10, "compliance_state": "compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent\n\ntools = [{{\"name\": \"parse_text\", \"description\": \"A useful tool for processing\"}}]\nagent = AssistantAgent(\n    \"agent\",\n    llm_config={{\"model\": \"claude-3-opus\", \"tools\": tools}},\n    system_message=\"Use tools for: data analysis and retrieval\"\n)\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \".\"}})\nuser.initiate_chat(agent, message=\"Help with this task\")", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 14-27", "metadata": {"framework": "autogen_v2", "article": 12, "compliance_state": "partially_compliant", "template": "tool_use_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"gpt-3.5-turbo\", max_tokens=547)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 23-32", "metadata": {"framework": "langchain_v2", "article": 10, "compliance_state": "partially_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from openai import OpenAI\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    stream=True,\n    temperature=0.9\n)\nfor chunk in stream:\n    if chunk.choices[0].delta.content:\n        print(chunk.choices[0].delta.content, end=\"\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 25-36", "metadata": {"framework": "openai_v2", "article": 10, "compliance_state": "non_compliant", "template": "streaming_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=940,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: Agent execution lacks structured decision documentation.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 11-19 have no structured audit logging integration.\\nRECOMMENDATION: Add decision record and model card documentation.", "metadata": {"framework": "anthropic", "article": 11, "compliance_state": "compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework has inconsistent PII handling.\\nARTICLE: 10\\nSEVERITY: HIGH\\nEVIDENCE: Lines 6-20 show different frameworks handling PII differently.\\nRECOMMENDATION: Enforce consistent PII protection layer protection across integration points.", "metadata": {"framework": "mixed_framework", "article": 10, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"claude-2\",\n    max_tokens=1201,\n    messages=messages\n)", "output": "FINDING: Anthropic agent processes input without PII protection.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 5-10 pass user data directly to API.\\nRECOMMENDATION: Wrap with PII protection layer for PII detection and encryption.", "metadata": {"framework": "anthropic", "article": 10, "compliance_state": "compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code has error handling but incomplete documentation.\\nARTICLE: 11\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 11-28 catch errors but lack structured audit logging decision records.\\nRECOMMENDATION: Add structured logging with decision context and model cards.", "metadata": {"framework": "edge_case_partial_compliance", "article": 11, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom pydantic import BaseModel\n\nclass Analysis(BaseModel):\n    summary: str\n    confidence: str\n\nllm = ChatOpenAI(model=\"gpt-3.5-turbo\", temperature=0.7)\nstructured_llm = llm.with_structured_output(Analysis)\nresponse = structured_llm.invoke([{{\"role\": \"user\", \"content\": \"Analyze this data\"}}])", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 3-18", "metadata": {"framework": "langchain_v2", "article": 15, "compliance_state": "non_compliant", "template": "structured_output_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=1237,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: Anthropic agent processes input without PII protection.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 14-33 pass user data directly to API.\\nRECOMMENDATION: Wrap with PII protection layer for PII detection and encryption.", "metadata": {"framework": "anthropic", "article": 10, "compliance_state": "partially_compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent\n\ntools = [{{\"name\": \"execute_query\", \"description\": \"A useful tool for processing\"}}]\nagent = AssistantAgent(\n    \"agent\",\n    llm_config={{\"model\": \"gpt-4\", \"tools\": tools}},\n    system_message=\"Use tools for: data analysis and retrieval\"\n)\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \".\"}})\nuser.initiate_chat(agent, message=\"Help with this task\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 29-43", "metadata": {"framework": "autogen_v2", "article": 10, "compliance_state": "partially_compliant", "template": "tool_use_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent\n\ntools = [{{\"name\": \"fetch_data\", \"description\": \"A useful tool for processing\"}}]\nagent = AssistantAgent(\n    \"agent\",\n    llm_config={{\"model\": \"gpt-4\", \"tools\": tools}},\n    system_message=\"Use tools for: data analysis and retrieval\"\n)\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \".\"}})\nuser.initiate_chat(agent, message=\"Help with this task\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 16-35", "metadata": {"framework": "autogen_v2", "article": 9, "compliance_state": "non_compliant", "template": "tool_use_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.agents import initialize_agent\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nllm = ChatOpenAI(model=\"gpt-4\")\ntools = load_tools([\"search\"])\nagent = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\ndef execute_with_logging(query):\n    logger.info(f\"Input: {What is AI?}\")\n    result = agent.run(query)\n    logger.info(f\"Output: {{result}}\")\n    return result", "output": "FINDING: Code has logging but missing risk classification.\\nARTICLE: 9\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 2-12 log events but lack risk classification system risk assessment.\\nRECOMMENDATION: Complete implementation with risk classification and user consent.", "metadata": {"framework": "edge_case_partial_compliance", "article": 9, "compliance_state": "partially_compliant", "template": "has_logging_no_hmac"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.chains import LLMChain\n\nchain = LLMChain(llm=ChatOpenAI(), prompt=prompt)\n\ndef safe_invoke(user_input):\n    try:\n        result = chain.run(input=user_input)\n        return {{\"success\": True, \"result\": result}}\n    except Exception as e:\n        logger.error(f\"Error: {{e}}\")\n        return {{\"success\": False, \"error\": str(e)}}", "output": "FINDING: Code validates length but misses injection patterns.\\nARTICLE: 15\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 3-10 have regex validation but incomplete prompt injection detection.\\nRECOMMENDATION: Expand validation to cover 15 injection attack patterns.", "metadata": {"framework": "edge_case_partial_compliance", "article": 15, "compliance_state": "partially_compliant", "template": "has_try_except_no_injection_detection"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.retrievers import BM25Retriever, MultiQueryRetriever\nfrom langchain.vectorstores import Chroma\nfrom langchain.embeddings import OpenAIEmbeddings\n\ndense_retriever = Chroma.from_documents(docs, OpenAIEmbeddings()).as_retriever()\nsparse_retriever = BM25Retriever.from_documents(docs)\nhybrid = MultiQueryRetriever(\n    retrievers=[dense_retriever, sparse_retriever],\n    llm=ChatOpenAI(model=\"gpt-3.5-turbo\")\n)\nresults = hybrid.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 28-41", "metadata": {"framework": "rag_v2", "article": 12, "compliance_state": "partially_compliant", "template": "hybrid_search"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code hides PII handling.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 18-23 use dynamic code execution hiding data flow.\\nRECOMMENDATION: Use transparent code with explicit PII protection layer protection.", "metadata": {"framework": "obfuscated_code", "article": 10, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom pydantic import BaseModel\n\nclass Output(BaseModel):\n    analysis: str\n    evidence: str\n\nllm = ChatOpenAI(model=\"claude-3-opus\", temperature=0.0)\nstructured_llm = llm.with_structured_output(Output)\nresponse = structured_llm.invoke([{{\"role\": \"user\", \"content\": \"What is this?\"}}])", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 6-21", "metadata": {"framework": "langchain_v2", "article": 14, "compliance_state": "non_compliant", "template": "structured_output_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=333,\n    messages=messages\n)", "output": "FINDING: Agent execution lacks structured decision documentation.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 1-20 have no structured audit logging integration.\\nRECOMMENDATION: Add decision record and model card documentation.", "metadata": {"framework": "anthropic", "article": 11, "compliance_state": "non_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.callbacks.streaming_stdout import StreamingStdOutCallbackHandler\n\nllm = ChatOpenAI(\n    model=\"claude-2\",\n    temperature=0.3,\n    callbacks=[StreamingStdOutCallbackHandler()]\n)\nmessages = [{{\"role\": \"user\", \"content\": \"Analyze this data\"}}]\nfor token in llm.stream(messages):\n    print(token.content, end=\"\")", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 9-24", "metadata": {"framework": "langchain_v2", "article": 12, "compliance_state": "non_compliant", "template": "streaming_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, config_list_from_json\n\nconfig_list = [{{\"model\": \"gpt-3.5-turbo\", \"api_key\": \"sk-xxxxxxxxxxxxxxxxxxxx\"}}]\nassistant = AssistantAgent(\"coder\", llm_config={{\"config_list\": config_list}})\nuser_proxy = UserProxyAgent(\n    \"user\",\n    human_input_mode=\"TERMINATE\",\n    code_execution_config={{\n        \"work_dir\": \"/tmp/agent\",\n        \"use_docker\": false\n    }}\n)\nuser_proxy.initiate_chat(assistant, message=\"Help with this task\")", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 18-31", "metadata": {"framework": "autogen_v2", "article": 12, "compliance_state": "non_compliant", "template": "code_executor_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework has no unified audit chain.\\nARTICLE: 12\\nSEVERITY: HIGH\\nEVIDENCE: Lines 3-15 show separate audit logs without HMAC chain.\\nRECOMMENDATION: Create unified HMAC-SHA256 audit chain across frameworks.", "metadata": {"framework": "mixed_framework", "article": 12, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, config_list_from_json\n\nconfig_list = [{{\"model\": \"gpt-4\", \"api_key\": \"sk-xxxxxxxxxxxxxxxxxxxx\"}}]\nassistant = AssistantAgent(\"coder\", llm_config={{\"config_list\": config_list}})\nuser_proxy = UserProxyAgent(\n    \"user\",\n    human_input_mode=\"TERMINATE\",\n    code_execution_config={{\n        \"work_dir\": \"./output\",\n        \"use_docker\": false\n    }}\n)\nuser_proxy.initiate_chat(assistant, message=\"Help with this task\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 8-28", "metadata": {"framework": "autogen_v2", "article": 10, "compliance_state": "partially_compliant", "template": "code_executor_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, config_list_from_json\n\nconfig_list = [{{\"model\": \"gpt-3.5-turbo\", \"api_key\": \"sk-xxxxxxxxxxxxxxxxxxxx\"}}]\nassistant = AssistantAgent(\"coder\", llm_config={{\"config_list\": config_list}})\nuser_proxy = UserProxyAgent(\n    \"user\",\n    human_input_mode=\"TERMINATE\",\n    code_execution_config={{\n        \"work_dir\": \"/tmp/agent\",\n        \"use_docker\": true\n    }}\n)\nuser_proxy.initiate_chat(assistant, message=\"Help with this task\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 17-33", "metadata": {"framework": "autogen_v2", "article": 15, "compliance_state": "non_compliant", "template": "code_executor_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.agents import initialize_agent\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nllm = ChatOpenAI(model=\"gpt-4\")\ntools = load_tools([\"search\"])\nagent = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\ndef execute_with_logging(query):\n    logger.info(f\"Input: {Summarize please}\")\n    result = agent.run(query)\n    logger.info(f\"Output: {{result}}\")\n    return result", "output": "FINDING: Code has input validation but no human override.\\nARTICLE: 14\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 28-35 validate input but lack HITL and kill switch.\\nRECOMMENDATION: Add human-in-the-loop approval and emergency stop.", "metadata": {"framework": "edge_case_partial_compliance", "article": 14, "compliance_state": "partially_compliant", "template": "has_logging_no_hmac"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.chains import LLMChain\n\nchain = LLMChain(llm=ChatOpenAI(), prompt=prompt)\n\ndef safe_invoke(user_input):\n    try:\n        result = chain.run(input=user_input)\n        return {{\"success\": True, \"result\": result}}\n    except Exception as e:\n        logger.error(f\"Error: {{e}}\")\n        return {{\"success\": False, \"error\": str(e)}}", "output": "FINDING: Code has error handling but incomplete documentation.\\nARTICLE: 11\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 11-18 catch errors but lack structured audit logging decision records.\\nRECOMMENDATION: Add structured logging with decision context and model cards.", "metadata": {"framework": "edge_case_partial_compliance", "article": 11, "compliance_state": "partially_compliant", "template": "has_try_except_no_injection_detection"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"claude-2\",\n    max_tokens=423,\n    messages=messages\n)", "output": "FINDING: No tamper-evident audit trail for agent decisions.\\nARTICLE: 12\\nSEVERITY: HIGH\\nEVIDENCE: Lines 21-37 lack HMAC-SHA256 chain.\\nRECOMMENDATION: Implement cryptographic audit logging with HMAC.", "metadata": {"framework": "anthropic", "article": 12, "compliance_state": "non_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 45}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=5)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 17-22", "metadata": {"framework": "rag_v2", "article": 14, "compliance_state": "non_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-2\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 17-31", "metadata": {"framework": "crewai_v2", "article": 10, "compliance_state": "non_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Researcher\",\n    goal=\"answer questions\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"research\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 19-24", "metadata": {"framework": "crewai_v2", "article": 11, "compliance_state": "partially_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"gpt-4\", max_tokens=1025)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 7-21", "metadata": {"framework": "langchain_v2", "article": 11, "compliance_state": "partially_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain_core.runnables import RunnableSequence\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.prompts import ChatPromptTemplate\n\nprompt = ChatPromptTemplate.from_template(\"What is this?\")\nllm = ChatOpenAI(model=\"gpt-4\", temperature=0.0)\nchain = prompt | llm\nresult = chain.invoke({{\"input\": \"test input\"}})", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 16-35", "metadata": {"framework": "langchain_v2", "article": 10, "compliance_state": "partially_compliant", "template": "lcel_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework oversight is fragmented.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 13-27 show autonomous execution across frameworks without HITL.\\nRECOMMENDATION: Implement unified HITL and kill switch for mixed execution.", "metadata": {"framework": "mixed_framework", "article": 14, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom pydantic import BaseModel\n\nclass Output(BaseModel):\n    answer: str\n    details: str\n\nllm = ChatOpenAI(model=\"claude-3-opus\", temperature=0.9)\nstructured_llm = llm.with_structured_output(Output)\nresponse = structured_llm.invoke([{{\"role\": \"user\", \"content\": \"Analyze this data\"}}])", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 25-33", "metadata": {"framework": "langchain_v2", "article": 12, "compliance_state": "non_compliant", "template": "structured_output_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from openai import OpenAI\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nstream = client.chat.completions.create(\n    model=\"gpt-3.5-turbo\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    stream=True,\n    temperature=0.9\n)\nfor chunk in stream:\n    if chunk.choices[0].delta.content:\n        print(chunk.choices[0].delta.content, end=\"\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 30-37", "metadata": {"framework": "openai_v2", "article": 15, "compliance_state": "non_compliant", "template": "streaming_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"solve problem\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"gpt-3.5-turbo\",\n        max_tokens=542,\n        system=\"You are Developer\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Anthropic agent processes input without PII protection.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 17-30 pass user data directly to API.\\nRECOMMENDATION: Wrap with PII protection layer for PII detection and encryption.", "metadata": {"framework": "anthropic", "article": 10, "compliance_state": "partially_compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code prevents injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 6-17 use code injection patterns themselves.\\nRECOMMENDATION: Use safe, transparent code with prompt injection detection.", "metadata": {"framework": "obfuscated_code", "article": 15, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    answer: str\n    details: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 17-24", "metadata": {"framework": "openai_v2", "article": 12, "compliance_state": "non_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"gpt-3.5-turbo\",\n    max_tokens=1415,\n    messages=messages\n)", "output": "FINDING: Anthropic agent lacks risk classification.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 23-35 show unguarded agent invocation without risk classification system.\\nRECOMMENDATION: Integrate risk classification system risk scoring and consent flow.", "metadata": {"framework": "anthropic", "article": 9, "compliance_state": "compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 29}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=6)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 13-31", "metadata": {"framework": "rag_v2", "article": 15, "compliance_state": "non_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    summary: str\n    details: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 28-34", "metadata": {"framework": "openai_v2", "article": 14, "compliance_state": "non_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.callbacks.streaming_stdout import StreamingStdOutCallbackHandler\n\nllm = ChatOpenAI(\n    model=\"claude-2\",\n    temperature=0.0,\n    callbacks=[StreamingStdOutCallbackHandler()]\n)\nmessages = [{{\"role\": \"user\", \"content\": \"What is this?\"}}]\nfor token in llm.stream(messages):\n    print(token.content, end=\"\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 27-40", "metadata": {"framework": "langchain_v2", "article": 9, "compliance_state": "partially_compliant", "template": "streaming_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain_core.runnables import RunnableSequence\nfrom langchain.chat_models import ChatOpenAI\nfrom langchain.prompts import ChatPromptTemplate\n\nprompt = ChatPromptTemplate.from_template(\"Analyze this data\")\nllm = ChatOpenAI(model=\"gpt-3.5-turbo\", temperature=0.7)\nchain = prompt | llm\nresult = chain.invoke({{\"input\": \"example\"}})", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 7-22", "metadata": {"framework": "langchain_v2", "article": 10, "compliance_state": "non_compliant", "template": "lcel_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code prevents risk assessment.\\nARTICLE: 9\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 28-38 use minification/obfuscation preventing analysis.\\nRECOMMENDATION: Provide source code and implement transparent risk classification system.", "metadata": {"framework": "obfuscated_code", "article": 9, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"gpt-3.5-turbo\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"gpt-3.5-turbo\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"./output\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 20-30", "metadata": {"framework": "autogen_v2", "article": 15, "compliance_state": "partially_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.agents import*;from langchain.chat_models import*;l=ChatOpenAI(model=\"gpt-4\");t=load_tools([\"search\"]);a=initialize_agent(t,l,agent=\"zero-shot\");r=a.run(\"query\")", "output": "FINDING: Obfuscated code hides PII handling.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 8-25 use dynamic code execution hiding data flow.\\nRECOMMENDATION: Use transparent code with explicit PII protection layer protection.", "metadata": {"framework": "obfuscated_code", "article": 10, "compliance_state": "non_compliant", "template": "minified_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent\n\ntools = [{{\"name\": \"fetch_data\", \"description\": \"A useful tool for processing\"}}]\nagent = AssistantAgent(\n    \"agent\",\n    llm_config={{\"model\": \"claude-2\", \"tools\": tools}},\n    system_message=\"Use tools for: data analysis and retrieval\"\n)\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \".\"}})\nuser.initiate_chat(agent, message=\"Help with this task\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 2-8", "metadata": {"framework": "autogen_v2", "article": 15, "compliance_state": "partially_compliant", "template": "tool_use_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code has logging but missing risk classification.\\nARTICLE: 9\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 5-25 log events but lack risk classification system risk assessment.\\nRECOMMENDATION: Complete implementation with risk classification and user consent.", "metadata": {"framework": "edge_case_partial_compliance", "article": 9, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"claude-3-opus\", max_tokens=843)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 9-18", "metadata": {"framework": "langchain_v2", "article": 9, "compliance_state": "non_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=376,\n    messages=messages\n)", "output": "FINDING: Agent execution lacks structured decision documentation.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 3-19 have no structured audit logging integration.\\nRECOMMENDATION: Add decision record and model card documentation.", "metadata": {"framework": "anthropic", "article": 11, "compliance_state": "non_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"gpt-3.5-turbo\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 10}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 10}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 3-9", "metadata": {"framework": "rag_v2", "article": 15, "compliance_state": "partially_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code prevents risk assessment.\\nARTICLE: 9\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 17-31 use minification/obfuscation preventing analysis.\\nRECOMMENDATION: Provide source code and implement transparent risk classification system.", "metadata": {"framework": "obfuscated_code", "article": 9, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 32}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=7)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 6-16", "metadata": {"framework": "rag_v2", "article": 10, "compliance_state": "partially_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=880,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: Agent executes without human oversight.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 11-22 show autonomous execution without HITL.\\nRECOMMENDATION: Add HITL queue and emergency kill switch.", "metadata": {"framework": "anthropic", "article": 14, "compliance_state": "non_compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.retrievers import BM25Retriever, MultiQueryRetriever\nfrom langchain.vectorstores import Chroma\nfrom langchain.embeddings import OpenAIEmbeddings\n\ndense_retriever = Chroma.from_documents(docs, OpenAIEmbeddings()).as_retriever()\nsparse_retriever = BM25Retriever.from_documents(docs)\nhybrid = MultiQueryRetriever(\n    retrievers=[dense_retriever, sparse_retriever],\n    llm=ChatOpenAI(model=\"gpt-3.5-turbo\")\n)\nresults = hybrid.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 14-24", "metadata": {"framework": "rag_v2", "article": 12, "compliance_state": "partially_compliant", "template": "hybrid_search"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from openai import OpenAI\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nstream = client.chat.completions.create(\n    model=\"claude-2\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    stream=True,\n    temperature=0.3\n)\nfor chunk in stream:\n    if chunk.choices[0].delta.content:\n        print(chunk.choices[0].delta.content, end=\"\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 8-21", "metadata": {"framework": "openai_v2", "article": 10, "compliance_state": "partially_compliant", "template": "streaming_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"analyze data\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"claude-2\",\n        max_tokens=1324,\n        system=\"You are Researcher\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Agent input validation missing injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 1-18 accept user input without prompt injection detection.\\nRECOMMENDATION: Deploy prompt injection detection for prompt injection protection.", "metadata": {"framework": "anthropic", "article": 15, "compliance_state": "non_compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code has input validation but no human override.\\nARTICLE: 14\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 22-33 validate input but lack HITL and kill switch.\\nRECOMMENDATION: Add human-in-the-loop approval and emergency stop.", "metadata": {"framework": "edge_case_partial_compliance", "article": 14, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.agents import initialize_agent\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nllm = ChatOpenAI(model=\"gpt-4\")\ntools = load_tools([\"search\"])\nagent = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\ndef execute_with_logging(query):\n    logger.info(f\"Input: {How does this work?}\")\n    result = agent.run(query)\n    logger.info(f\"Output: {{result}}\")\n    return result", "output": "FINDING: Code validates length but misses injection patterns.\\nARTICLE: 15\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 24-36 have regex validation but incomplete prompt injection detection.\\nRECOMMENDATION: Expand validation to cover 15 injection attack patterns.", "metadata": {"framework": "edge_case_partial_compliance", "article": 15, "compliance_state": "partially_compliant", "template": "has_logging_no_hmac"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from openai import OpenAI\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    stream=True,\n    temperature=0.7\n)\nfor chunk in stream:\n    if chunk.choices[0].delta.content:\n        print(chunk.choices[0].delta.content, end=\"\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 27-46", "metadata": {"framework": "openai_v2", "article": 10, "compliance_state": "non_compliant", "template": "streaming_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    analysis: str\n    evidence: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"gpt-3.5-turbo\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 4-20", "metadata": {"framework": "openai_v2", "article": 9, "compliance_state": "non_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 28}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=10)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 15-31", "metadata": {"framework": "rag_v2", "article": 14, "compliance_state": "non_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"claude-3-opus\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 5}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 5}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 19-33", "metadata": {"framework": "rag_v2", "article": 11, "compliance_state": "non_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom pydantic import BaseModel\n\nclass Output(BaseModel):\n    summary: str\n    evidence: str\n\nllm = ChatOpenAI(model=\"gpt-3.5-turbo\", temperature=0.9)\nstructured_llm = llm.with_structured_output(Output)\nresponse = structured_llm.invoke([{{\"role\": \"user\", \"content\": \"What is this?\"}}])", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 15-32", "metadata": {"framework": "langchain_v2", "article": 11, "compliance_state": "partially_compliant", "template": "structured_output_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.chains import LLMChain\n\nchain = LLMChain(llm=ChatOpenAI(), prompt=prompt)\n\ndef safe_invoke(user_input):\n    try:\n        result = chain.run(input=user_input)\n        return {{\"success\": True, \"result\": result}}\n    except Exception as e:\n        logger.error(f\"Error: {{e}}\")\n        return {{\"success\": False, \"error\": str(e)}}", "output": "FINDING: Code has logging but missing risk classification.\\nARTICLE: 9\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 16-33 log events but lack risk classification system risk assessment.\\nRECOMMENDATION: Complete implementation with risk classification and user consent.", "metadata": {"framework": "edge_case_partial_compliance", "article": 9, "compliance_state": "partially_compliant", "template": "has_try_except_no_injection_detection"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework has inconsistent PII handling.\\nARTICLE: 10\\nSEVERITY: HIGH\\nEVIDENCE: Lines 17-30 show different frameworks handling PII differently.\\nRECOMMENDATION: Enforce consistent PII protection layer protection across integration points.", "metadata": {"framework": "mixed_framework", "article": 10, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    analysis: str\n    evidence: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"gpt-3.5-turbo\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 18-24", "metadata": {"framework": "openai_v2", "article": 14, "compliance_state": "partially_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from openai import OpenAI\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nstream = client.chat.completions.create(\n    model=\"claude-3-opus\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    stream=True,\n    temperature=0.7\n)\nfor chunk in stream:\n    if chunk.choices[0].delta.content:\n        print(chunk.choices[0].delta.content, end=\"\")", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 8-15", "metadata": {"framework": "openai_v2", "article": 12, "compliance_state": "partially_compliant", "template": "streaming_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.agents import initialize_agent\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nllm = ChatOpenAI(model=\"gpt-4\")\ntools = load_tools([\"search\"])\nagent = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\ndef execute_with_logging(query):\n    logger.info(f\"Input: {Summarize please}\")\n    result = agent.run(query)\n    logger.info(f\"Output: {{result}}\")\n    return result", "output": "FINDING: Code validates input length but no PII detection.\\nARTICLE: 10\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 3-19 have input validation but miss PII protection layer integration.\\nRECOMMENDATION: Add PII detection and encryption to security layer.", "metadata": {"framework": "edge_case_partial_compliance", "article": 10, "compliance_state": "partially_compliant", "template": "has_logging_no_hmac"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"claude-3-opus\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 9}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 9}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 13-27", "metadata": {"framework": "rag_v2", "article": 11, "compliance_state": "non_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework has inconsistent PII handling.\\nARTICLE: 10\\nSEVERITY: HIGH\\nEVIDENCE: Lines 18-38 show different frameworks handling PII differently.\\nRECOMMENDATION: Enforce consistent PII protection layer protection across integration points.", "metadata": {"framework": "mixed_framework", "article": 10, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.retrievers import BM25Retriever, MultiQueryRetriever\nfrom langchain.vectorstores import Chroma\nfrom langchain.embeddings import OpenAIEmbeddings\n\ndense_retriever = Chroma.from_documents(docs, OpenAIEmbeddings()).as_retriever()\nsparse_retriever = BM25Retriever.from_documents(docs)\nhybrid = MultiQueryRetriever(\n    retrievers=[dense_retriever, sparse_retriever],\n    llm=ChatOpenAI(model=\"gpt-3.5-turbo\")\n)\nresults = hybrid.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 12-28", "metadata": {"framework": "rag_v2", "article": 9, "compliance_state": "partially_compliant", "template": "hybrid_search"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework has no unified audit chain.\\nARTICLE: 12\\nSEVERITY: HIGH\\nEVIDENCE: Lines 27-46 show separate audit logs without HMAC chain.\\nRECOMMENDATION: Create unified HMAC-SHA256 audit chain across frameworks.", "metadata": {"framework": "mixed_framework", "article": 12, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.callbacks.streaming_stdout import StreamingStdOutCallbackHandler\n\nllm = ChatOpenAI(\n    model=\"gpt-4\",\n    temperature=0.7,\n    callbacks=[StreamingStdOutCallbackHandler()]\n)\nmessages = [{{\"role\": \"user\", \"content\": \"Help me understand\"}}]\nfor token in llm.stream(messages):\n    print(token.content, end=\"\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 10-26", "metadata": {"framework": "langchain_v2", "article": 15, "compliance_state": "partially_compliant", "template": "streaming_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from openai import OpenAI\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    stream=True,\n    temperature=0.9\n)\nfor chunk in stream:\n    if chunk.choices[0].delta.content:\n        print(chunk.choices[0].delta.content, end=\"\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 14-25", "metadata": {"framework": "openai_v2", "article": 11, "compliance_state": "partially_compliant", "template": "streaming_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from time import sleep\nfrom langchain.chat_models import ChatOpenAI\n\nclient = ChatOpenAI(model=\"gpt-4\")\ncall_count = 0\nlast_call_time = 0\nrate_limit = 60  # 1 per second\n\ndef rate_limited_call(prompt):\n    global call_count, last_call_time\n    elapsed = time.time() - last_call_time\n    if elapsed < rate_limit:\n        sleep(rate_limit - elapsed)\n    response = client.invoke(prompt)\n    call_count += 1\n    return response", "output": "FINDING: Code logs events but lacks cryptographic integrity.\\nARTICLE: 12\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 25-31 have basic logging without HMAC chain.\\nRECOMMENDATION: Upgrade to HMAC-SHA256 tamper-evident audit logs.", "metadata": {"framework": "edge_case_partial_compliance", "article": 12, "compliance_state": "partially_compliant", "template": "has_rate_limiting_no_audit"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from openai import OpenAI\nimport json\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nbatch_input = [\n    {{\"custom_id\": \"req-0\", \"params\": {{\"model\": \"claude-3-opus\", \"messages\": [message]}}}}\n    for i in range(79)\n]\nbatch_file = client.files.create(\n    file=json.dumps(batch_input),\n    purpose=\"batch\"\n)\nbatch_job = client.beta.batch.create(input_file_id=batch_file.id)", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 11-16", "metadata": {"framework": "openai_v2", "article": 11, "compliance_state": "non_compliant", "template": "batch_api"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from openai import OpenAI\nimport json\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nbatch_input = [\n    {{\"custom_id\": \"req-0\", \"params\": {{\"model\": \"claude-3-opus\", \"messages\": [message]}}}}\n    for i in range(50)\n]\nbatch_file = client.files.create(\n    file=json.dumps(batch_input),\n    purpose=\"batch\"\n)\nbatch_job = client.beta.batch.create(input_file_id=batch_file.id)", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 6-25", "metadata": {"framework": "openai_v2", "article": 9, "compliance_state": "partially_compliant", "template": "batch_api"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"claude-3-opus\",\n    max_tokens=454,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: Agent input validation missing injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 18-33 accept user input without prompt injection detection.\\nRECOMMENDATION: Deploy prompt injection detection for prompt injection protection.", "metadata": {"framework": "anthropic", "article": 15, "compliance_state": "non_compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.retrievers import BM25Retriever, MultiQueryRetriever\nfrom langchain.vectorstores import Chroma\nfrom langchain.embeddings import OpenAIEmbeddings\n\ndense_retriever = Chroma.from_documents(docs, OpenAIEmbeddings()).as_retriever()\nsparse_retriever = BM25Retriever.from_documents(docs)\nhybrid = MultiQueryRetriever(\n    retrievers=[dense_retriever, sparse_retriever],\n    llm=ChatOpenAI(model=\"gpt-4\")\n)\nresults = hybrid.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 3-13", "metadata": {"framework": "rag_v2", "article": 10, "compliance_state": "non_compliant", "template": "hybrid_search"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 49}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=7)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 13-19", "metadata": {"framework": "rag_v2", "article": 10, "compliance_state": "partially_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"gpt-3.5-turbo\", max_tokens=839)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 14-29", "metadata": {"framework": "langchain_v2", "article": 9, "compliance_state": "non_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Researcher\",\n    goal=\"solve problems\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"research\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 12-24", "metadata": {"framework": "crewai_v2", "article": 14, "compliance_state": "non_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"gpt-3.5-turbo\", max_tokens=900)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 9-26", "metadata": {"framework": "langchain_v2", "article": 11, "compliance_state": "non_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent\n\ntools = [{{\"name\": \"fetch_data\", \"description\": \"A useful tool for processing\"}}]\nagent = AssistantAgent(\n    \"agent\",\n    llm_config={{\"model\": \"claude-3-opus\", \"tools\": tools}},\n    system_message=\"Use tools for: data analysis and retrieval\"\n)\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \".\"}})\nuser.initiate_chat(agent, message=\"Help with this task\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 16-21", "metadata": {"framework": "autogen_v2", "article": 9, "compliance_state": "partially_compliant", "template": "tool_use_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from openai import OpenAI\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nstream = client.chat.completions.create(\n    model=\"claude-3-opus\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    stream=True,\n    temperature=0.9\n)\nfor chunk in stream:\n    if chunk.choices[0].delta.content:\n        print(chunk.choices[0].delta.content, end=\"\")", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 9-25", "metadata": {"framework": "openai_v2", "article": 15, "compliance_state": "partially_compliant", "template": "streaming_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"claude-2\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"claude-2\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"/tmp/agent\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 28-47", "metadata": {"framework": "autogen_v2", "article": 12, "compliance_state": "partially_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent\n\ntools = [{{\"name\": \"execute_query\", \"description\": \"A useful tool for processing\"}}]\nagent = AssistantAgent(\n    \"agent\",\n    llm_config={{\"model\": \"gpt-4\", \"tools\": tools}},\n    system_message=\"Use tools for: data analysis and retrieval\"\n)\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \".\"}})\nuser.initiate_chat(agent, message=\"Help with this task\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 4-23", "metadata": {"framework": "autogen_v2", "article": 9, "compliance_state": "partially_compliant", "template": "tool_use_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.agents import initialize_agent\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nllm = ChatOpenAI(model=\"gpt-4\")\ntools = load_tools([\"search\"])\nagent = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\ndef execute_with_logging(query):\n    logger.info(f\"Input: {What is AI?}\")\n    result = agent.run(query)\n    logger.info(f\"Output: {{result}}\")\n    return result", "output": "FINDING: Code logs events but lacks cryptographic integrity.\\nARTICLE: 12\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 27-40 have basic logging without HMAC chain.\\nRECOMMENDATION: Upgrade to HMAC-SHA256 tamper-evident audit logs.", "metadata": {"framework": "edge_case_partial_compliance", "article": 12, "compliance_state": "partially_compliant", "template": "has_logging_no_hmac"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-2\")\nagents = [\n    Agent(role=\"Researcher\", goal=\"Research topic\", llm=llm),\n    Agent(role=\"Implementer\", goal=\"Implement solution\", llm=llm)\n]\ntasks = [\n    Task(description=\"Research component\", agent=agents[0]),\n    Task(description=\"Build component\", agent=agents[1])\n]\ncrew = Crew(agents=agents, tasks=tasks, process=\"sequential\")\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 16-22", "metadata": {"framework": "crewai_v2", "article": 11, "compliance_state": "non_compliant", "template": "sequential_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.agents import*;from langchain.chat_models import*;l=ChatOpenAI(model=\"gpt-4\");t=load_tools([\"search\"]);a=initialize_agent(t,l,agent=\"zero-shot\");r=a.run(\"query\")", "output": "FINDING: Obfuscated code prevents risk assessment.\\nARTICLE: 9\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 9-25 use minification/obfuscation preventing analysis.\\nRECOMMENDATION: Provide source code and implement transparent risk classification system.", "metadata": {"framework": "obfuscated_code", "article": 9, "compliance_state": "non_compliant", "template": "minified_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"make decision\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"claude-2\",\n        max_tokens=1380,\n        system=\"You are Researcher\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Agent executes without human oversight.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 27-36 show autonomous execution without HITL.\\nRECOMMENDATION: Add HITL queue and emergency kill switch.", "metadata": {"framework": "anthropic", "article": 14, "compliance_state": "partially_compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from openai import OpenAI\nimport json\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nbatch_input = [\n    {{\"custom_id\": \"req-0\", \"params\": {{\"model\": \"claude-3-opus\", \"messages\": [message]}}}}\n    for i in range(71)\n]\nbatch_file = client.files.create(\n    file=json.dumps(batch_input),\n    purpose=\"batch\"\n)\nbatch_job = client.beta.batch.create(input_file_id=batch_file.id)", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 16-24", "metadata": {"framework": "openai_v2", "article": 14, "compliance_state": "non_compliant", "template": "batch_api"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework validation is inconsistent.\\nARTICLE: 15\\nSEVERITY: HIGH\\nEVIDENCE: Lines 27-33 have different validation per framework.\\nRECOMMENDATION: Deploy unified prompt injection detection across all input points.", "metadata": {"framework": "mixed_framework", "article": 15, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Analyst\",\n    goal=\"analyze data\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"test\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 18-38", "metadata": {"framework": "crewai_v2", "article": 12, "compliance_state": "non_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"solve problem\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"gpt-4\",\n        max_tokens=821,\n        system=\"You are Developer\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Agent input validation missing injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 11-30 accept user input without prompt injection detection.\\nRECOMMENDATION: Deploy prompt injection detection for prompt injection protection.", "metadata": {"framework": "anthropic", "article": 15, "compliance_state": "partially_compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"gpt-3.5-turbo\",\n    max_tokens=1108,\n    messages=messages\n)", "output": "FINDING: Agent execution lacks structured decision documentation.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 24-37 have no structured audit logging integration.\\nRECOMMENDATION: Add decision record and model card documentation.", "metadata": {"framework": "anthropic", "article": 11, "compliance_state": "non_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.chains import LLMChain\n\nchain = LLMChain(llm=ChatOpenAI(), prompt=prompt)\n\ndef safe_invoke(user_input):\n    try:\n        result = chain.run(input=user_input)\n        return {{\"success\": True, \"result\": result}}\n    except Exception as e:\n        logger.error(f\"Error: {{e}}\")\n        return {{\"success\": False, \"error\": str(e)}}", "output": "FINDING: Code has input validation but no human override.\\nARTICLE: 14\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 30-48 validate input but lack HITL and kill switch.\\nRECOMMENDATION: Add human-in-the-loop approval and emergency stop.", "metadata": {"framework": "edge_case_partial_compliance", "article": 14, "compliance_state": "partially_compliant", "template": "has_try_except_no_injection_detection"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework lacks unified risk assessment.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 5-23 combine frameworks without integrated risk classification system.\\nRECOMMENDATION: Implement unified risk classification across all frameworks.", "metadata": {"framework": "mixed_framework", "article": 9, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 45}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=10)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 28-39", "metadata": {"framework": "rag_v2", "article": 14, "compliance_state": "partially_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Researcher\",\n    goal=\"solve problems\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"implement\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 23-37", "metadata": {"framework": "crewai_v2", "article": 10, "compliance_state": "non_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework audit trail is fragmented.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 22-29 have disconnected logging between frameworks.\\nRECOMMENDATION: Use structured audit logging for unified decision documentation.", "metadata": {"framework": "mixed_framework", "article": 11, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, config_list_from_json\n\nconfig_list = [{{\"model\": \"claude-2\", \"api_key\": \"sk-xxxxxxxxxxxxxxxxxxxx\"}}]\nassistant = AssistantAgent(\"coder\", llm_config={{\"config_list\": config_list}})\nuser_proxy = UserProxyAgent(\n    \"user\",\n    human_input_mode=\"TERMINATE\",\n    code_execution_config={{\n        \"work_dir\": \"./output\",\n        \"use_docker\": true\n    }}\n)\nuser_proxy.initiate_chat(assistant, message=\"Help with this task\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 19-33", "metadata": {"framework": "autogen_v2", "article": 11, "compliance_state": "non_compliant", "template": "code_executor_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"claude-3-opus\", max_tokens=349)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 7-19", "metadata": {"framework": "langchain_v2", "article": 14, "compliance_state": "non_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"claude-3-opus\", max_tokens=601)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 11-27", "metadata": {"framework": "langchain_v2", "article": 10, "compliance_state": "non_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.callbacks.streaming_stdout import StreamingStdOutCallbackHandler\n\nllm = ChatOpenAI(\n    model=\"claude-2\",\n    temperature=0.3,\n    callbacks=[StreamingStdOutCallbackHandler()]\n)\nmessages = [{{\"role\": \"user\", \"content\": \"Help me understand\"}}]\nfor token in llm.stream(messages):\n    print(token.content, end=\"\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 1-16", "metadata": {"framework": "langchain_v2", "article": 9, "compliance_state": "partially_compliant", "template": "streaming_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"gpt-3.5-turbo\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 28-38", "metadata": {"framework": "crewai_v2", "article": 11, "compliance_state": "non_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"gpt-4\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 26-40", "metadata": {"framework": "crewai_v2", "article": 10, "compliance_state": "partially_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"claude-2\",\n    max_tokens=822,\n    messages=messages\n)", "output": "FINDING: Agent input validation missing injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 19-37 accept user input without prompt injection detection.\\nRECOMMENDATION: Deploy prompt injection detection for prompt injection protection.", "metadata": {"framework": "anthropic", "article": 15, "compliance_state": "compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from openai import OpenAI\nimport json\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nbatch_input = [\n    {{\"custom_id\": \"req-0\", \"params\": {{\"model\": \"gpt-3.5-turbo\", \"messages\": [message]}}}}\n    for i in range(89)\n]\nbatch_file = client.files.create(\n    file=json.dumps(batch_input),\n    purpose=\"batch\"\n)\nbatch_job = client.beta.batch.create(input_file_id=batch_file.id)", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 4-24", "metadata": {"framework": "openai_v2", "article": 10, "compliance_state": "partially_compliant", "template": "batch_api"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    answer: str\n    evidence: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"gpt-3.5-turbo\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 26-37", "metadata": {"framework": "openai_v2", "article": 9, "compliance_state": "non_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    summary: str\n    details: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"gpt-3.5-turbo\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 1-16", "metadata": {"framework": "openai_v2", "article": 11, "compliance_state": "non_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.agents import initialize_agent\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nllm = ChatOpenAI(model=\"gpt-4\")\ntools = load_tools([\"search\"])\nagent = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\ndef execute_with_logging(query):\n    logger.info(f\"Input: {Summarize please}\")\n    result = agent.run(query)\n    logger.info(f\"Output: {{result}}\")\n    return result", "output": "FINDING: Code has input validation but no human override.\\nARTICLE: 14\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 19-26 validate input but lack HITL and kill switch.\\nRECOMMENDATION: Add human-in-the-loop approval and emergency stop.", "metadata": {"framework": "edge_case_partial_compliance", "article": 14, "compliance_state": "partially_compliant", "template": "has_logging_no_hmac"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"gpt-3.5-turbo\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 26-36", "metadata": {"framework": "crewai_v2", "article": 14, "compliance_state": "partially_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code validates input length but no PII detection.\\nARTICLE: 10\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 22-36 have input validation but miss PII protection layer integration.\\nRECOMMENDATION: Add PII detection and encryption to security layer.", "metadata": {"framework": "edge_case_partial_compliance", "article": 10, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.callbacks.streaming_stdout import StreamingStdOutCallbackHandler\n\nllm = ChatOpenAI(\n    model=\"claude-3-opus\",\n    temperature=0.9,\n    callbacks=[StreamingStdOutCallbackHandler()]\n)\nmessages = [{{\"role\": \"user\", \"content\": \"What is this?\"}}]\nfor token in llm.stream(messages):\n    print(token.content, end=\"\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 17-27", "metadata": {"framework": "langchain_v2", "article": 11, "compliance_state": "non_compliant", "template": "streaming_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code prevents audit chain.\\nARTICLE: 12\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 6-12 dynamically execute code preventing HMAC logging.\\nRECOMMENDATION: Use transparent code with cryptographically signed audit logs.", "metadata": {"framework": "obfuscated_code", "article": 12, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom pydantic import BaseModel\n\nclass Result(BaseModel):\n    analysis: str\n    evidence: str\n\nllm = ChatOpenAI(model=\"gpt-4\", temperature=0.9)\nstructured_llm = llm.with_structured_output(Result)\nresponse = structured_llm.invoke([{{\"role\": \"user\", \"content\": \"Analyze this data\"}}])", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 2-14", "metadata": {"framework": "langchain_v2", "article": 15, "compliance_state": "non_compliant", "template": "structured_output_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.agents import*;from langchain.chat_models import*;l=ChatOpenAI(model=\"gpt-4\");t=load_tools([\"search\"]);a=initialize_agent(t,l,agent=\"zero-shot\");r=a.run(\"query\")", "output": "FINDING: Obfuscated code prevents audit chain.\\nARTICLE: 12\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 26-37 dynamically execute code preventing HMAC logging.\\nRECOMMENDATION: Use transparent code with cryptographically signed audit logs.", "metadata": {"framework": "obfuscated_code", "article": 12, "compliance_state": "non_compliant", "template": "minified_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code hides PII handling.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 20-32 use dynamic code execution hiding data flow.\\nRECOMMENDATION: Use transparent code with explicit PII protection layer protection.", "metadata": {"framework": "obfuscated_code", "article": 10, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"claude-3-opus\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"claude-3-opus\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"/tmp/agent\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 15-27", "metadata": {"framework": "autogen_v2", "article": 9, "compliance_state": "non_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code prevents audit chain.\\nARTICLE: 12\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 14-20 dynamically execute code preventing HMAC logging.\\nRECOMMENDATION: Use transparent code with cryptographically signed audit logs.", "metadata": {"framework": "obfuscated_code", "article": 12, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"claude-3-opus\",\n    max_tokens=795,\n    messages=messages\n)", "output": "FINDING: Agent executes without human oversight.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 26-42 show autonomous execution without HITL.\\nRECOMMENDATION: Add HITL queue and emergency kill switch.", "metadata": {"framework": "anthropic", "article": 14, "compliance_state": "non_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework has no unified audit chain.\\nARTICLE: 12\\nSEVERITY: HIGH\\nEVIDENCE: Lines 29-41 show separate audit logs without HMAC chain.\\nRECOMMENDATION: Create unified HMAC-SHA256 audit chain across frameworks.", "metadata": {"framework": "mixed_framework", "article": 12, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom pydantic import BaseModel\n\nclass Analysis(BaseModel):\n    answer: str\n    details: str\n\nllm = ChatOpenAI(model=\"gpt-4\", temperature=0.9)\nstructured_llm = llm.with_structured_output(Analysis)\nresponse = structured_llm.invoke([{{\"role\": \"user\", \"content\": \"Analyze this data\"}}])", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 30-45", "metadata": {"framework": "langchain_v2", "article": 15, "compliance_state": "non_compliant", "template": "structured_output_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, config_list_from_json\n\nconfig_list = [{{\"model\": \"gpt-4\", \"api_key\": \"sk-xxxxxxxxxxxxxxxxxxxx\"}}]\nassistant = AssistantAgent(\"coder\", llm_config={{\"config_list\": config_list}})\nuser_proxy = UserProxyAgent(\n    \"user\",\n    human_input_mode=\"TERMINATE\",\n    code_execution_config={{\n        \"work_dir\": \"./work\",\n        \"use_docker\": true\n    }}\n)\nuser_proxy.initiate_chat(assistant, message=\"Help with this task\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 17-35", "metadata": {"framework": "autogen_v2", "article": 14, "compliance_state": "non_compliant", "template": "code_executor_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.agents import*;from langchain.chat_models import*;l=ChatOpenAI(model=\"gpt-4\");t=load_tools([\"search\"]);a=initialize_agent(t,l,agent=\"zero-shot\");r=a.run(\"query\")", "output": "FINDING: Obfuscated code prevents injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 1-11 use code injection patterns themselves.\\nRECOMMENDATION: Use safe, transparent code with prompt injection detection.", "metadata": {"framework": "obfuscated_code", "article": 15, "compliance_state": "non_compliant", "template": "minified_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from openai import OpenAI\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nstream = client.chat.completions.create(\n    model=\"gpt-3.5-turbo\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    stream=True,\n    temperature=0.7\n)\nfor chunk in stream:\n    if chunk.choices[0].delta.content:\n        print(chunk.choices[0].delta.content, end=\"\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 15-25", "metadata": {"framework": "openai_v2", "article": 14, "compliance_state": "partially_compliant", "template": "streaming_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    summary: str\n    details: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"claude-3-opus\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 20-34", "metadata": {"framework": "openai_v2", "article": 10, "compliance_state": "non_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"claude-2\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"claude-2\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"./output\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 8-26", "metadata": {"framework": "autogen_v2", "article": 14, "compliance_state": "partially_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"claude-2\",\n    max_tokens=452,\n    messages=messages\n)", "output": "FINDING: Anthropic agent lacks risk classification.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 10-23 show unguarded agent invocation without risk classification system.\\nRECOMMENDATION: Integrate risk classification system risk scoring and consent flow.", "metadata": {"framework": "anthropic", "article": 9, "compliance_state": "non_compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from time import sleep\nfrom langchain.chat_models import ChatOpenAI\n\nclient = ChatOpenAI(model=\"gpt-4\")\ncall_count = 0\nlast_call_time = 0\nrate_limit = 60  # 1 per second\n\ndef rate_limited_call(prompt):\n    global call_count, last_call_time\n    elapsed = time.time() - last_call_time\n    if elapsed < rate_limit:\n        sleep(rate_limit - elapsed)\n    response = client.invoke(prompt)\n    call_count += 1\n    return response", "output": "FINDING: Code has error handling but incomplete documentation.\\nARTICLE: 11\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 13-32 catch errors but lack structured audit logging decision records.\\nRECOMMENDATION: Add structured logging with decision context and model cards.", "metadata": {"framework": "edge_case_partial_compliance", "article": 11, "compliance_state": "partially_compliant", "template": "has_rate_limiting_no_audit"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"claude-3-opus\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"claude-3-opus\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"./work\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 13-23", "metadata": {"framework": "autogen_v2", "article": 11, "compliance_state": "partially_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Developer\",\n    goal=\"answer questions\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"analyze\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 1-7", "metadata": {"framework": "crewai_v2", "article": 9, "compliance_state": "non_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    analysis: str\n    confidence: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"gpt-3.5-turbo\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 23-32", "metadata": {"framework": "openai_v2", "article": 12, "compliance_state": "partially_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"analyze data\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"gpt-4\",\n        max_tokens=1712,\n        system=\"You are Developer\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Agent execution lacks structured decision documentation.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 28-34 have no structured audit logging integration.\\nRECOMMENDATION: Add decision record and model card documentation.", "metadata": {"framework": "anthropic", "article": 11, "compliance_state": "partially_compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Developer\",\n    goal=\"analyze data\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"test\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 19-33", "metadata": {"framework": "crewai_v2", "article": 9, "compliance_state": "partially_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"claude-3-opus\", max_tokens=1597)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 21-41", "metadata": {"framework": "langchain_v2", "article": 15, "compliance_state": "partially_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-3-opus\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 18-29", "metadata": {"framework": "crewai_v2", "article": 9, "compliance_state": "partially_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"claude-3-opus\",\n    max_tokens=1028,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: No tamper-evident audit trail for agent decisions.\\nARTICLE: 12\\nSEVERITY: HIGH\\nEVIDENCE: Lines 8-17 lack HMAC-SHA256 chain.\\nRECOMMENDATION: Implement cryptographic audit logging with HMAC.", "metadata": {"framework": "anthropic", "article": 12, "compliance_state": "non_compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\ntools = [\n    {{\n        \"name\": \"parse_text\",\n        \"description\": \"A useful tool for processing\",\n        \"input_schema\": {{\"type\": \"object\", \"properties\": {{\"input\": {{\"type\": \"string\"}}}}}}\n    }}\n]\n\nresponse = client.messages.create(\n    model=\"gpt-3.5-turbo\",\n    max_tokens=1156,\n    tools=tools,\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)", "output": "FINDING: Agent input validation missing injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 4-16 accept user input without prompt injection detection.\\nRECOMMENDATION: Deploy prompt injection detection for prompt injection protection.", "metadata": {"framework": "anthropic", "article": 15, "compliance_state": "compliant", "template": "agent_with_mcp_tools"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from time import sleep\nfrom langchain.chat_models import ChatOpenAI\n\nclient = ChatOpenAI(model=\"gpt-4\")\ncall_count = 0\nlast_call_time = 0\nrate_limit = 60  # 1 per second\n\ndef rate_limited_call(prompt):\n    global call_count, last_call_time\n    elapsed = time.time() - last_call_time\n    if elapsed < rate_limit:\n        sleep(rate_limit - elapsed)\n    response = client.invoke(prompt)\n    call_count += 1\n    return response", "output": "FINDING: Code has error handling but incomplete documentation.\\nARTICLE: 11\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 27-46 catch errors but lack structured audit logging decision records.\\nRECOMMENDATION: Add structured logging with decision context and model cards.", "metadata": {"framework": "edge_case_partial_compliance", "article": 11, "compliance_state": "partially_compliant", "template": "has_rate_limiting_no_audit"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"gpt-3.5-turbo\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 17-26", "metadata": {"framework": "crewai_v2", "article": 12, "compliance_state": "partially_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=261,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: Anthropic agent lacks risk classification.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 23-34 show unguarded agent invocation without risk classification system.\\nRECOMMENDATION: Integrate risk classification system risk scoring and consent flow.", "metadata": {"framework": "anthropic", "article": 9, "compliance_state": "partially_compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.agents import*;from langchain.chat_models import*;l=ChatOpenAI(model=\"gpt-4\");t=load_tools([\"search\"]);a=initialize_agent(t,l,agent=\"zero-shot\");r=a.run(\"query\")", "output": "FINDING: Obfuscated code prevents decision documentation.\\nARTICLE: 11\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 9-22 use eval()/exec() preventing audit logging.\\nRECOMMENDATION: Replace dynamic code with explicit structured audit logging integration.", "metadata": {"framework": "obfuscated_code", "article": 11, "compliance_state": "non_compliant", "template": "minified_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"make decision\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"gpt-4\",\n        max_tokens=2031,\n        system=\"You are Developer\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Agent executes without human oversight.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 1-9 show autonomous execution without HITL.\\nRECOMMENDATION: Add HITL queue and emergency kill switch.", "metadata": {"framework": "anthropic", "article": 14, "compliance_state": "compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"gpt-4\", max_tokens=1742)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 18-26", "metadata": {"framework": "langchain_v2", "article": 10, "compliance_state": "non_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"gpt-4\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 3}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 3}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 27-46", "metadata": {"framework": "rag_v2", "article": 9, "compliance_state": "partially_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code hides PII handling.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 17-31 use dynamic code execution hiding data flow.\\nRECOMMENDATION: Use transparent code with explicit PII protection layer protection.", "metadata": {"framework": "obfuscated_code", "article": 10, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"claude-2\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"claude-2\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"./work\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 26-40", "metadata": {"framework": "autogen_v2", "article": 15, "compliance_state": "partially_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.callbacks.streaming_stdout import StreamingStdOutCallbackHandler\n\nllm = ChatOpenAI(\n    model=\"gpt-3.5-turbo\",\n    temperature=0.3,\n    callbacks=[StreamingStdOutCallbackHandler()]\n)\nmessages = [{{\"role\": \"user\", \"content\": \"What is this?\"}}]\nfor token in llm.stream(messages):\n    print(token.content, end=\"\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 17-37", "metadata": {"framework": "langchain_v2", "article": 10, "compliance_state": "partially_compliant", "template": "streaming_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code validates input length but no PII detection.\\nARTICLE: 10\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 29-37 have input validation but miss PII protection layer integration.\\nRECOMMENDATION: Add PII detection and encryption to security layer.", "metadata": {"framework": "edge_case_partial_compliance", "article": 10, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from openai import OpenAI\nimport json\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nbatch_input = [\n    {{\"custom_id\": \"req-0\", \"params\": {{\"model\": \"claude-2\", \"messages\": [message]}}}}\n    for i in range(74)\n]\nbatch_file = client.files.create(\n    file=json.dumps(batch_input),\n    purpose=\"batch\"\n)\nbatch_job = client.beta.batch.create(input_file_id=batch_file.id)", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 8-20", "metadata": {"framework": "openai_v2", "article": 15, "compliance_state": "partially_compliant", "template": "batch_api"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"analyze data\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"claude-3-opus\",\n        max_tokens=1161,\n        system=\"You are Researcher\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: No tamper-evident audit trail for agent decisions.\\nARTICLE: 12\\nSEVERITY: HIGH\\nEVIDENCE: Lines 29-40 lack HMAC-SHA256 chain.\\nRECOMMENDATION: Implement cryptographic audit logging with HMAC.", "metadata": {"framework": "anthropic", "article": 12, "compliance_state": "partially_compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Developer\",\n    goal=\"solve problems\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"implement\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 14-20", "metadata": {"framework": "crewai_v2", "article": 14, "compliance_state": "partially_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom pydantic import BaseModel\n\nclass Response(BaseModel):\n    summary: str\n    details: str\n\nllm = ChatOpenAI(model=\"claude-3-opus\", temperature=0.7)\nstructured_llm = llm.with_structured_output(Response)\nresponse = structured_llm.invoke([{{\"role\": \"user\", \"content\": \"What is this?\"}}])", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 21-29", "metadata": {"framework": "langchain_v2", "article": 9, "compliance_state": "partially_compliant", "template": "structured_output_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from openai import OpenAI\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nstream = client.chat.completions.create(\n    model=\"gpt-3.5-turbo\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    stream=True,\n    temperature=0.3\n)\nfor chunk in stream:\n    if chunk.choices[0].delta.content:\n        print(chunk.choices[0].delta.content, end=\"\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 1-10", "metadata": {"framework": "openai_v2", "article": 10, "compliance_state": "partially_compliant", "template": "streaming_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nmessages = [\n    {{\"role\": \"user\", \"content\": \"{prompt}\"}}\n]\nresponse = client.messages.create(\n    model=\"gpt-4\",\n    max_tokens=704,\n    messages=messages\n)", "output": "FINDING: Anthropic agent processes input without PII protection.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 20-30 pass user data directly to API.\\nRECOMMENDATION: Wrap with PII protection layer for PII detection and encryption.", "metadata": {"framework": "anthropic", "article": 10, "compliance_state": "compliant", "template": "basic_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-3-opus\")\nagents = [\n    Agent(role=\"Researcher\", goal=\"Research topic\", llm=llm),\n    Agent(role=\"Implementer\", goal=\"Implement solution\", llm=llm)\n]\ntasks = [\n    Task(description=\"Research component\", agent=agents[0]),\n    Task(description=\"Build component\", agent=agents[1])\n]\ncrew = Crew(agents=agents, tasks=tasks, process=\"sequential\")\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 3-13", "metadata": {"framework": "crewai_v2", "article": 15, "compliance_state": "partially_compliant", "template": "sequential_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from openai import OpenAI\nimport json\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nbatch_input = [\n    {{\"custom_id\": \"req-0\", \"params\": {{\"model\": \"claude-3-opus\", \"messages\": [message]}}}}\n    for i in range(56)\n]\nbatch_file = client.files.create(\n    file=json.dumps(batch_input),\n    purpose=\"batch\"\n)\nbatch_job = client.beta.batch.create(input_file_id=batch_file.id)", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 2-19", "metadata": {"framework": "openai_v2", "article": 11, "compliance_state": "non_compliant", "template": "batch_api"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from openai import OpenAI\nimport json\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nbatch_input = [\n    {{\"custom_id\": \"req-0\", \"params\": {{\"model\": \"claude-3-opus\", \"messages\": [message]}}}}\n    for i in range(78)\n]\nbatch_file = client.files.create(\n    file=json.dumps(batch_input),\n    purpose=\"batch\"\n)\nbatch_job = client.beta.batch.create(input_file_id=batch_file.id)", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 21-38", "metadata": {"framework": "openai_v2", "article": 12, "compliance_state": "partially_compliant", "template": "batch_api"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code prevents decision documentation.\\nARTICLE: 11\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 15-30 use eval()/exec() preventing audit logging.\\nRECOMMENDATION: Replace dynamic code with explicit structured audit logging integration.", "metadata": {"framework": "obfuscated_code", "article": 11, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent\n\ntools = [{{\"name\": \"execute_query\", \"description\": \"A useful tool for processing\"}}]\nagent = AssistantAgent(\n    \"agent\",\n    llm_config={{\"model\": \"claude-2\", \"tools\": tools}},\n    system_message=\"Use tools for: data analysis and retrieval\"\n)\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \".\"}})\nuser.initiate_chat(agent, message=\"Help with this task\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 16-22", "metadata": {"framework": "autogen_v2", "article": 9, "compliance_state": "partially_compliant", "template": "tool_use_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from time import sleep\nfrom langchain.chat_models import ChatOpenAI\n\nclient = ChatOpenAI(model=\"gpt-4\")\ncall_count = 0\nlast_call_time = 0\nrate_limit = 60  # 1 per second\n\ndef rate_limited_call(prompt):\n    global call_count, last_call_time\n    elapsed = time.time() - last_call_time\n    if elapsed < rate_limit:\n        sleep(rate_limit - elapsed)\n    response = client.invoke(prompt)\n    call_count += 1\n    return response", "output": "FINDING: Code has input validation but no human override.\\nARTICLE: 14\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 12-25 validate input but lack HITL and kill switch.\\nRECOMMENDATION: Add human-in-the-loop approval and emergency stop.", "metadata": {"framework": "edge_case_partial_compliance", "article": 14, "compliance_state": "partially_compliant", "template": "has_rate_limiting_no_audit"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"gpt-3.5-turbo\", max_tokens=537)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 30-49", "metadata": {"framework": "langchain_v2", "article": 14, "compliance_state": "partially_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.chains import LLMChain\n\nchain = LLMChain(llm=ChatOpenAI(), prompt=prompt)\n\ndef safe_invoke(user_input):\n    try:\n        result = chain.run(input=user_input)\n        return {{\"success\": True, \"result\": result}}\n    except Exception as e:\n        logger.error(f\"Error: {{e}}\")\n        return {{\"success\": False, \"error\": str(e)}}", "output": "FINDING: Code validates length but misses injection patterns.\\nARTICLE: 15\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 13-33 have regex validation but incomplete prompt injection detection.\\nRECOMMENDATION: Expand validation to cover 15 injection attack patterns.", "metadata": {"framework": "edge_case_partial_compliance", "article": 15, "compliance_state": "partially_compliant", "template": "has_try_except_no_injection_detection"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.agents import*;from langchain.chat_models import*;l=ChatOpenAI(model=\"gpt-4\");t=load_tools([\"search\"]);a=initialize_agent(t,l,agent=\"zero-shot\");r=a.run(\"query\")", "output": "FINDING: Obfuscated code prevents human oversight.\\nARTICLE: 14\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 8-15 dynamically execute operations without HITL.\\nRECOMMENDATION: Use transparent code with integrated human review.", "metadata": {"framework": "obfuscated_code", "article": 14, "compliance_state": "non_compliant", "template": "minified_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from time import sleep\nfrom langchain.chat_models import ChatOpenAI\n\nclient = ChatOpenAI(model=\"gpt-4\")\ncall_count = 0\nlast_call_time = 0\nrate_limit = 60  # 1 per second\n\ndef rate_limited_call(prompt):\n    global call_count, last_call_time\n    elapsed = time.time() - last_call_time\n    if elapsed < rate_limit:\n        sleep(rate_limit - elapsed)\n    response = client.invoke(prompt)\n    call_count += 1\n    return response", "output": "FINDING: Code logs events but lacks cryptographic integrity.\\nARTICLE: 12\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 11-20 have basic logging without HMAC chain.\\nRECOMMENDATION: Upgrade to HMAC-SHA256 tamper-evident audit logs.", "metadata": {"framework": "edge_case_partial_compliance", "article": 12, "compliance_state": "partially_compliant", "template": "has_rate_limiting_no_audit"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.retrievers import BM25Retriever, MultiQueryRetriever\nfrom langchain.vectorstores import Chroma\nfrom langchain.embeddings import OpenAIEmbeddings\n\ndense_retriever = Chroma.from_documents(docs, OpenAIEmbeddings()).as_retriever()\nsparse_retriever = BM25Retriever.from_documents(docs)\nhybrid = MultiQueryRetriever(\n    retrievers=[dense_retriever, sparse_retriever],\n    llm=ChatOpenAI(model=\"claude-2\")\n)\nresults = hybrid.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 5-15", "metadata": {"framework": "rag_v2", "article": 9, "compliance_state": "non_compliant", "template": "hybrid_search"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from time import sleep\nfrom langchain.chat_models import ChatOpenAI\n\nclient = ChatOpenAI(model=\"gpt-4\")\ncall_count = 0\nlast_call_time = 0\nrate_limit = 60  # 1 per second\n\ndef rate_limited_call(prompt):\n    global call_count, last_call_time\n    elapsed = time.time() - last_call_time\n    if elapsed < rate_limit:\n        sleep(rate_limit - elapsed)\n    response = client.invoke(prompt)\n    call_count += 1\n    return response", "output": "FINDING: Code validates length but misses injection patterns.\\nARTICLE: 15\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 24-33 have regex validation but incomplete prompt injection detection.\\nRECOMMENDATION: Expand validation to cover 15 injection attack patterns.", "metadata": {"framework": "edge_case_partial_compliance", "article": 15, "compliance_state": "partially_compliant", "template": "has_rate_limiting_no_audit"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"claude-3-opus\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 8}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 8}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 25-41", "metadata": {"framework": "rag_v2", "article": 9, "compliance_state": "non_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"claude-3-opus\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 10}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 10}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"What is AI?\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 27-43", "metadata": {"framework": "rag_v2", "article": 11, "compliance_state": "partially_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom crewai.memory import ShortTermMemory, LongTermMemory\n\nagent = Agent(\n    role=\"Analyst\",\n    goal=\"analyze data\",\n    memory=True,\n    verbose=True\n)\ntask = Task(description=\"test\", agent=agent)\ncrew = Crew(agents=[agent], tasks=[task], memory=True)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 16-22", "metadata": {"framework": "crewai_v2", "article": 9, "compliance_state": "partially_compliant", "template": "crew_with_memory"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"gpt-4\")\nagents = [\n    Agent(role=\"Researcher\", goal=\"Research topic\", llm=llm),\n    Agent(role=\"Implementer\", goal=\"Implement solution\", llm=llm)\n]\ntasks = [\n    Task(description=\"Research component\", agent=agents[0]),\n    Task(description=\"Build component\", agent=agents[1])\n]\ncrew = Crew(agents=agents, tasks=tasks, process=\"sequential\")\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 18-24", "metadata": {"framework": "crewai_v2", "article": 15, "compliance_state": "non_compliant", "template": "sequential_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.chains import LLMChain\nimport re\n\ndef validate_input(user_input):\n    if len(user_input) > 1000:\n        raise ValueError(\"Input too long\")\n    if not re.match(r\"^[\\w\\s,.!?]+$\", user_input):\n        raise ValueError(\"Invalid characters\")\n    return True\n\ndef execute_agent(user_input):\n    validate_input(user_input)\n    result = agent.run(user_input)\n    return result", "output": "FINDING: Code logs events but lacks cryptographic integrity.\\nARTICLE: 12\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 30-48 have basic logging without HMAC chain.\\nRECOMMENDATION: Upgrade to HMAC-SHA256 tamper-evident audit logs.", "metadata": {"framework": "edge_case_partial_compliance", "article": 12, "compliance_state": "partially_compliant", "template": "has_input_validation_no_override"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.agents import*;from langchain.chat_models import*;l=ChatOpenAI(model=\"gpt-4\");t=load_tools([\"search\"]);a=initialize_agent(t,l,agent=\"zero-shot\");r=a.run(\"query\")", "output": "FINDING: Obfuscated code prevents audit chain.\\nARTICLE: 12\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 8-26 dynamically execute code preventing HMAC logging.\\nRECOMMENDATION: Use transparent code with cryptographically signed audit logs.", "metadata": {"framework": "obfuscated_code", "article": 12, "compliance_state": "non_compliant", "template": "minified_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code prevents audit chain.\\nARTICLE: 12\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 29-43 dynamically execute code preventing HMAC logging.\\nRECOMMENDATION: Use transparent code with cryptographically signed audit logs.", "metadata": {"framework": "obfuscated_code", "article": 12, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"claude-3-opus\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"claude-3-opus\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"/tmp/agent\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 3-12", "metadata": {"framework": "autogen_v2", "article": 14, "compliance_state": "partially_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"gpt-4\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 17-33", "metadata": {"framework": "crewai_v2", "article": 11, "compliance_state": "partially_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.agents import*;from langchain.chat_models import*;l=ChatOpenAI(model=\"gpt-4\");t=load_tools([\"search\"]);a=initialize_agent(t,l,agent=\"zero-shot\");r=a.run(\"query\")", "output": "FINDING: Obfuscated code hides PII handling.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 11-19 use dynamic code execution hiding data flow.\\nRECOMMENDATION: Use transparent code with explicit PII protection layer protection.", "metadata": {"framework": "obfuscated_code", "article": 10, "compliance_state": "non_compliant", "template": "minified_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.retrievers import BM25Retriever, MultiQueryRetriever\nfrom langchain.vectorstores import Chroma\nfrom langchain.embeddings import OpenAIEmbeddings\n\ndense_retriever = Chroma.from_documents(docs, OpenAIEmbeddings()).as_retriever()\nsparse_retriever = BM25Retriever.from_documents(docs)\nhybrid = MultiQueryRetriever(\n    retrievers=[dense_retriever, sparse_retriever],\n    llm=ChatOpenAI(model=\"gpt-4\")\n)\nresults = hybrid.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 6-16", "metadata": {"framework": "rag_v2", "article": 9, "compliance_state": "non_compliant", "template": "hybrid_search"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "import importlib;fw=importlib.import_module(\"langchain.agents\");ag=fw.initialize_agent(tools,llm,agent_type=\"zero-shot-react-description\");result=ag.run(user_query)", "output": "FINDING: Obfuscated code prevents risk assessment.\\nARTICLE: 9\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 28-45 use minification/obfuscation preventing analysis.\\nRECOMMENDATION: Provide source code and implement transparent risk classification system.", "metadata": {"framework": "obfuscated_code", "article": 9, "compliance_state": "non_compliant", "template": "dynamic_import"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code prevents human oversight.\\nARTICLE: 14\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 4-17 dynamically execute operations without HITL.\\nRECOMMENDATION: Use transparent code with integrated human review.", "metadata": {"framework": "obfuscated_code", "article": 14, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"gpt-3.5-turbo\")\nagents = [\n    Agent(role=\"Researcher\", goal=\"Research topic\", llm=llm),\n    Agent(role=\"Implementer\", goal=\"Implement solution\", llm=llm)\n]\ntasks = [\n    Task(description=\"Research component\", agent=agents[0]),\n    Task(description=\"Build component\", agent=agents[1])\n]\ncrew = Crew(agents=agents, tasks=tasks, process=\"sequential\")\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 10-17", "metadata": {"framework": "crewai_v2", "article": 9, "compliance_state": "non_compliant", "template": "sequential_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from openai import OpenAI\nfrom pydantic import BaseModel\n\nclass APIResponse(BaseModel):\n    analysis: str\n    confidence: str\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nresponse = client.beta.chat.completions.parse(\n    model=\"claude-3-opus\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}],\n    response_format=APIResponse\n)\nparsed = response.choices[0].message.parsed", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 6-14", "metadata": {"framework": "openai_v2", "article": 15, "compliance_state": "non_compliant", "template": "structured_outputs"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework validation is inconsistent.\\nARTICLE: 15\\nSEVERITY: HIGH\\nEVIDENCE: Lines 6-12 have different validation per framework.\\nRECOMMENDATION: Deploy unified prompt injection detection across all input points.", "metadata": {"framework": "mixed_framework", "article": 15, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-2\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 4-13", "metadata": {"framework": "crewai_v2", "article": 10, "compliance_state": "partially_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code prevents injection detection.\\nARTICLE: 15\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 7-17 use code injection patterns themselves.\\nRECOMMENDATION: Use safe, transparent code with prompt injection detection.", "metadata": {"framework": "obfuscated_code", "article": 15, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"gpt-4\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 3}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 3}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 21-37", "metadata": {"framework": "rag_v2", "article": 12, "compliance_state": "non_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from openai import OpenAI\nimport json\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nbatch_input = [\n    {{\"custom_id\": \"req-0\", \"params\": {{\"model\": \"gpt-3.5-turbo\", \"messages\": [message]}}}}\n    for i in range(94)\n]\nbatch_file = client.files.create(\n    file=json.dumps(batch_input),\n    purpose=\"batch\"\n)\nbatch_job = client.beta.batch.create(input_file_id=batch_file.id)", "output": "FINDING: Code review for Article 9.\\nARTICLE: 9\\nEVIDENCE: Lines 18-27", "metadata": {"framework": "openai_v2", "article": 9, "compliance_state": "non_compliant", "template": "batch_api"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from openai import OpenAI\nimport json\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nbatch_input = [\n    {{\"custom_id\": \"req-0\", \"params\": {{\"model\": \"gpt-4\", \"messages\": [message]}}}}\n    for i in range(56)\n]\nbatch_file = client.files.create(\n    file=json.dumps(batch_input),\n    purpose=\"batch\"\n)\nbatch_job = client.beta.batch.create(input_file_id=batch_file.id)", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 18-31", "metadata": {"framework": "openai_v2", "article": 14, "compliance_state": "partially_compliant", "template": "batch_api"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, config_list_from_json\n\nconfig_list = [{{\"model\": \"claude-3-opus\", \"api_key\": \"sk-xxxxxxxxxxxxxxxxxxxx\"}}]\nassistant = AssistantAgent(\"coder\", llm_config={{\"config_list\": config_list}})\nuser_proxy = UserProxyAgent(\n    \"user\",\n    human_input_mode=\"TERMINATE\",\n    code_execution_config={{\n        \"work_dir\": \"/tmp/agent\",\n        \"use_docker\": false\n    }}\n)\nuser_proxy.initiate_chat(assistant, message=\"Help with this task\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 6-19", "metadata": {"framework": "autogen_v2", "article": 10, "compliance_state": "non_compliant", "template": "code_executor_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-2\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 14-22", "metadata": {"framework": "crewai_v2", "article": 10, "compliance_state": "non_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"analyze data\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"claude-2\",\n        max_tokens=1062,\n        system=\"You are Developer\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Agent executes without human oversight.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 20-31 show autonomous execution without HITL.\\nRECOMMENDATION: Add HITL queue and emergency kill switch.", "metadata": {"framework": "anthropic", "article": 14, "compliance_state": "compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework oversight is fragmented.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 25-44 show autonomous execution across frameworks without HITL.\\nRECOMMENDATION: Implement unified HITL and kill switch for mixed execution.", "metadata": {"framework": "mixed_framework", "article": 14, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-2\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 21-38", "metadata": {"framework": "crewai_v2", "article": 14, "compliance_state": "non_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"claude-3-opus\")\nmanager = Agent(role=\"Manager\", goal=\"Oversee execution\", llm=llm)\nworker = Agent(role=\"Worker\", goal=\"Execute tasks\", llm=llm)\ncrew = Crew(\n    agents=[manager, worker],\n    tasks=[task1, task2],\n    process=\"hierarchical\",\n    manager_agent=manager\n)\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 17-34", "metadata": {"framework": "crewai_v2", "article": 14, "compliance_state": "non_compliant", "template": "hierarchical_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from openai import OpenAI\nimport json\n\nclient = OpenAI(api_key=\"sk-xxxxxxxxxxxxxxxxxxxx\")\nbatch_input = [\n    {{\"custom_id\": \"req-0\", \"params\": {{\"model\": \"claude-2\", \"messages\": [message]}}}}\n    for i in range(24)\n]\nbatch_file = client.files.create(\n    file=json.dumps(batch_input),\n    purpose=\"batch\"\n)\nbatch_job = client.beta.batch.create(input_file_id=batch_file.id)", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 4-24", "metadata": {"framework": "openai_v2", "article": 11, "compliance_state": "partially_compliant", "template": "batch_api"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from anthropic import Anthropic\n\ndef apply_guardrails(response_text):\n    blocked_patterns = [\"forbidden_word1\", \"forbidden_word2\", \"forbidden_word3\"]\n    for pattern in blocked_patterns:\n        if pattern.lower() in response_text.lower():\n            return None\n    return response_text\n\nclient = Anthropic()\nresponse = client.messages.create(\n    model=\"gpt-3.5-turbo\",\n    max_tokens=306,\n    system=\"You are a helpful assistant. Do not violate these policies: no illegal content\",\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)\nsafe_response = apply_guardrails(response.content[0].text)", "output": "FINDING: Agent executes without human oversight.\\nARTICLE: 14\\nSEVERITY: HIGH\\nEVIDENCE: Lines 10-18 show autonomous execution without HITL.\\nRECOMMENDATION: Add HITL queue and emergency kill switch.", "metadata": {"framework": "anthropic", "article": 14, "compliance_state": "non_compliant", "template": "agent_with_guardrails"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework validation is inconsistent.\\nARTICLE: 15\\nSEVERITY: HIGH\\nEVIDENCE: Lines 30-40 have different validation per framework.\\nRECOMMENDATION: Deploy unified prompt injection detection across all input points.", "metadata": {"framework": "mixed_framework", "article": 15, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\nstate = {{\"current_agent\": \"agent1\", \"task\": \"analyze data\", \"status\": \"pending\"}}\n\nwhile state[\"status\"] != \"complete\":\n    response = client.messages.create(\n        model=\"gpt-3.5-turbo\",\n        max_tokens=441,\n        system=\"You are Developer\",\n        messages=[{{\"role\": \"user\", \"content\": state[\"task\"]}}]\n    )\n    state[\"response\"] = response.content[0].text\n    state[\"current_agent\"] = \"agent2\" if state[\"current_agent\"] == \"agent1\" else \"agent1\"", "output": "FINDING: Anthropic agent lacks risk classification.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 19-38 show unguarded agent invocation without risk classification system.\\nRECOMMENDATION: Integrate risk classification system risk scoring and consent flow.", "metadata": {"framework": "anthropic", "article": 9, "compliance_state": "compliant", "template": "multi_agent_handoff"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom langchain.chat_models import ChatOpenAI\n\nllm = ChatOpenAI(model=\"gpt-4\")\nagents = [\n    Agent(role=\"Researcher\", goal=\"Research topic\", llm=llm),\n    Agent(role=\"Implementer\", goal=\"Implement solution\", llm=llm)\n]\ntasks = [\n    Task(description=\"Research component\", agent=agents[0]),\n    Task(description=\"Build component\", agent=agents[1])\n]\ncrew = Crew(agents=agents, tasks=tasks, process=\"sequential\")\nresult = crew.kickoff()", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 3-8", "metadata": {"framework": "crewai_v2", "article": 15, "compliance_state": "partially_compliant", "template": "sequential_crew"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 21}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=7)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 4-19", "metadata": {"framework": "rag_v2", "article": 14, "compliance_state": "partially_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.agents import initialize_agent\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\nlogger = logging.getLogger(__name__)\n\nllm = ChatOpenAI(model=\"gpt-4\")\ntools = load_tools([\"search\"])\nagent = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\ndef execute_with_logging(query):\n    logger.info(f\"Input: {What is AI?}\")\n    result = agent.run(query)\n    logger.info(f\"Output: {{result}}\")\n    return result", "output": "FINDING: Code validates input length but no PII detection.\\nARTICLE: 10\\nSEVERITY: MEDIUM\\nEVIDENCE: Lines 16-36 have input validation but miss PII protection layer integration.\\nRECOMMENDATION: Add PII detection and encryption to security layer.", "metadata": {"framework": "edge_case_partial_compliance", "article": 10, "compliance_state": "partially_compliant", "template": "has_logging_no_hmac"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 9 (Risk Management System) compliance.", "input": "from langchain.agents import initialize_agent\nfrom autogen import AssistantAgent\n\n# LangChain component\nlc_chain = initialize_agent(tools, llm, agent=\"zero-shot-react-description\")\n\n# AutoGen component\nautogen_agent = AssistantAgent(\"helper\", llm_config={{\"model\": \"gpt-4\"}})\n\n# Mixed execution\nlc_result = lc_chain.run(query)\nautogen_result = autogen_agent.generate_reply(messages=[{{\"role\": \"user\", \"content\": lc_result}}])", "output": "FINDING: Mixed framework lacks unified risk assessment.\\nARTICLE: 9\\nSEVERITY: HIGH\\nEVIDENCE: Lines 11-26 combine frameworks without integrated risk classification system.\\nRECOMMENDATION: Implement unified risk classification across all frameworks.", "metadata": {"framework": "mixed_framework", "article": 9, "compliance_state": "non_compliant", "template": "langchain_with_autogen"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from langchain.retrievers import BM25Retriever, MultiQueryRetriever\nfrom langchain.vectorstores import Chroma\nfrom langchain.embeddings import OpenAIEmbeddings\n\ndense_retriever = Chroma.from_documents(docs, OpenAIEmbeddings()).as_retriever()\nsparse_retriever = BM25Retriever.from_documents(docs)\nhybrid = MultiQueryRetriever(\n    retrievers=[dense_retriever, sparse_retriever],\n    llm=ChatOpenAI(model=\"claude-2\")\n)\nresults = hybrid.get_relevant_documents(\"Summarize please\")", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 3-9", "metadata": {"framework": "rag_v2", "article": 12, "compliance_state": "non_compliant", "template": "hybrid_search"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "from langchain.chat_models import ChatOpenAI\nfrom langchain.schema.messages import HumanMessage\nfrom langchain_core.messages import BaseMessage\n\nclient = ChatOpenAI(model=\"gpt-4\", max_tokens=705)\nimage_url = \"https://example.com/image.jpg\"\nmessage = HumanMessage(\n    content=[\n        {{\"type\": \"image_url\", \"image_url\": {{\"url\": image_url}}}},\n        {{\"type\": \"text\", \"text\": \"Describe this image\"}}\n    ]\n)\nresponse = client([message])", "output": "FINDING: Code review for Article 14.\\nARTICLE: 14\\nEVIDENCE: Lines 22-32", "metadata": {"framework": "langchain_v2", "article": 14, "compliance_state": "non_compliant", "template": "multimodal_chain"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.retrievers import MultiRetriever\nfrom langchain.vectorstores import Chroma, FAISS\nfrom langchain.embeddings import OpenAIEmbeddings\n\nembeddings = OpenAIEmbeddings(model=\"gpt-3.5-turbo\")\nchroma_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 9}})\nfaiss_retriever = FAISS.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 9}})\nmulti = MultiRetriever(retrievers=[chroma_retriever, faiss_retriever])\nresults = multi.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 5-18", "metadata": {"framework": "rag_v2", "article": 10, "compliance_state": "non_compliant", "template": "multi_retriever"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"gpt-4\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"gpt-4\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"/tmp/agent\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 15.\\nARTICLE: 15\\nEVIDENCE: Lines 8-22", "metadata": {"framework": "autogen_v2", "article": 15, "compliance_state": "non_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 12 (Record-Keeping & Audit Logging) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, Agent\n\nagent1 = AssistantAgent(\"agent1\", llm_config={{\"model\": \"claude-2\"}})\nagent2 = AssistantAgent(\"agent2\", llm_config={{\"model\": \"claude-2\"}})\nuser = UserProxyAgent(\"user\", code_execution_config={{\"work_dir\": \"/tmp/agent\"}})\n\nuser.initiate_chats([\n    {{\"recipient\": agent1, \"message\": \"Analyze this please\"}},\n    {{\"recipient\": agent2, \"message\": \"Then implement it\"}}\n])", "output": "FINDING: Code review for Article 12.\\nARTICLE: 12\\nEVIDENCE: Lines 3-19", "metadata": {"framework": "autogen_v2", "article": 12, "compliance_state": "non_compliant", "template": "nested_chat"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 15 (Robustness & Input Validation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework validation is inconsistent.\\nARTICLE: 15\\nSEVERITY: HIGH\\nEVIDENCE: Lines 28-48 have different validation per framework.\\nRECOMMENDATION: Deploy unified prompt injection detection across all input points.", "metadata": {"framework": "mixed_framework", "article": 15, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from anthropic import Anthropic\n\nclient = Anthropic()\ntools = [\n    {{\n        \"name\": \"execute_query\",\n        \"description\": \"A useful tool for processing\",\n        \"input_schema\": {{\"type\": \"object\", \"properties\": {{\"input\": {{\"type\": \"string\"}}}}}}\n    }}\n]\n\nresponse = client.messages.create(\n    model=\"claude-2\",\n    max_tokens=886,\n    tools=tools,\n    messages=[{{\"role\": \"user\", \"content\": \"{prompt}\"}}]\n)", "output": "FINDING: Anthropic agent processes input without PII protection.\\nARTICLE: 10\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 21-29 pass user data directly to API.\\nRECOMMENDATION: Wrap with PII protection layer for PII detection and encryption.", "metadata": {"framework": "anthropic", "article": 10, "compliance_state": "non_compliant", "template": "agent_with_mcp_tools"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 14 (Human Oversight & Kill Switch) compliance.", "input": "import json;c=json.loads('{\"agent\":\"gpt4\",\"tools\":[\"search\"]}');exec(\"from langchain.agents import initialize_agent;a = initialize_agent(c['tools'],llm,c['agent'])\")", "output": "FINDING: Obfuscated code prevents human oversight.\\nARTICLE: 14\\nSEVERITY: CRITICAL\\nEVIDENCE: Lines 22-37 dynamically execute operations without HITL.\\nRECOMMENDATION: Use transparent code with integrated human review.", "metadata": {"framework": "obfuscated_code", "article": 14, "compliance_state": "non_compliant", "template": "eval_based_code"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from autogen import AssistantAgent, UserProxyAgent, config_list_from_json\n\nconfig_list = [{{\"model\": \"claude-2\", \"api_key\": \"sk-xxxxxxxxxxxxxxxxxxxx\"}}]\nassistant = AssistantAgent(\"coder\", llm_config={{\"config_list\": config_list}})\nuser_proxy = UserProxyAgent(\n    \"user\",\n    human_input_mode=\"TERMINATE\",\n    code_execution_config={{\n        \"work_dir\": \"/tmp/agent\",\n        \"use_docker\": true\n    }}\n)\nuser_proxy.initiate_chat(assistant, message=\"Help with this task\")", "output": "FINDING: Code review for Article 11.\\nARTICLE: 11\\nEVIDENCE: Lines 20-38", "metadata": {"framework": "autogen_v2", "article": 11, "compliance_state": "non_compliant", "template": "code_executor_agent"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 10 (Data Governance & Privacy) compliance.", "input": "from langchain.retrievers import ContextualCompressionRetriever\nfrom langchain.retrievers.document_compressors import CohereRerank\nfrom langchain.vectorstores import Chroma\n\nbase_retriever = Chroma.from_documents(docs, embeddings).as_retriever(search_kwargs={{\"k\": 24}})\ncompressor = CohereRerank(model=\"reranker-v3\", top_n=9)\nretriever = ContextualCompressionRetriever(\n    base_compressor=compressor,\n    base_retriever=base_retriever\n)\nresults = retriever.get_relevant_documents(\"How does this work?\")", "output": "FINDING: Code review for Article 10.\\nARTICLE: 10\\nEVIDENCE: Lines 7-26", "metadata": {"framework": "rag_v2", "article": 10, "compliance_state": "non_compliant", "template": "reranking_pipeline"}}
{"instruction": "Analyze this Python AI agent code for EU AI Act Article 11 (Technical Documentation) compliance.", "input": "from crewai import Agent, Task, Crew\nfrom openai import OpenAI\n\n# CrewAI component\ncrew_agent = Agent(role=\"Analyzer\", goal=\"Analyze data\")\ncrew = Crew(agents=[crew_agent], tasks=[task])\n\n# Direct OpenAI streaming\nclient = OpenAI()\nstream = client.chat.completions.create(\n    model=\"gpt-4\",\n    messages=[{{\"role\": \"user\", \"content\": crew.kickoff()}}],\n    stream=True\n)", "output": "FINDING: Mixed framework audit trail is fragmented.\\nARTICLE: 11\\nSEVERITY: HIGH\\nEVIDENCE: Lines 10-24 have disconnected logging between frameworks.\\nRECOMMENDATION: Use structured audit logging for unified decision documentation.", "metadata": {"framework": "mixed_framework", "article": 11, "compliance_state": "non_compliant", "template": "crewai_with_openai_streaming"}}
